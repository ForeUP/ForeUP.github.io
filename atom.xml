<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://foreup.github.io/</id>
    <title>ForeUP&apos;s Blog</title>
    <updated>2022-02-07T11:23:03.187Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://foreup.github.io/"/>
    <link rel="self" href="https://foreup.github.io/atom.xml"/>
    <subtitle>温故而知新</subtitle>
    <logo>https://foreup.github.io/images/avatar.png</logo>
    <icon>https://foreup.github.io/favicon.ico</icon>
    <rights>All rights reserved 2022, ForeUP&apos;s Blog</rights>
    <entry>
        <title type="html"><![CDATA[0207-高级特性-高级函数]]></title>
        <id>https://foreup.github.io/post/0207-gao-ji-te-xing-gao-ji-han-shu/</id>
        <link href="https://foreup.github.io/post/0207-gao-ji-te-xing-gao-ji-han-shu/">
        </link>
        <updated>2022-02-07T11:21:58.000Z</updated>
        <content type="html"><![CDATA[<h2 id="函数的参数">函数的参数</h2>
<p><strong>位置参数</strong><br>
按照对应的位置引用参数；<br>
<strong>默认参数</strong></p>
<pre><code class="language-python">def power(x, n=2):
    s = 1
    while n &gt; 0:
        n = n - 1
        s = s * x
    return s
#调用
&gt;&gt;&gt; power(5)
25
&gt;&gt;&gt; power(5, 2)
25
</code></pre>
<p>例子2:</p>
<pre><code class="language-python">def enroll(name, gender, age=6, city='Beijing'):
    print('name:', name)
    print('gender:', gender)
    print('age:', age)
    print('city:', city)
</code></pre>
<p>不按顺序提供部分默认参数时，需要把参数名写上。比如调用<code>enroll('Adam', 'M', city='Tianjin')</code>，意思是，city参数用传进去的值，其他默认参数继续使用默认值。<br>
默认参数的<strong>坑</strong>:<br>
定义一个函数，传入一个<code>list</code>，添加一个END再返回：</p>
<pre><code class="language-python">def add_end(L=[]):
    L.append('END')
    return L
#调用
&gt;&gt;&gt; add_end()
['END']
#但是，再次调用add_end()时，结果就不对了：
&gt;&gt;&gt; add_end()
['END', 'END']
&gt;&gt;&gt; add_end()
['END', 'END', 'END']
</code></pre>
<p>应该用None这个不变对象来实现：</p>
<pre><code class="language-python">def add_end(L=None):
    if L is None:
        L = []
    L.append('END')
    return L
</code></pre>
<p><strong>可变参数</strong><br>
给定一组数字a，b，c……，请计算a<sup>2</sup> + b<sup>2</sup>  + c<sup>2</sup>  + ……<br>
方法一: 对于提前组装好的<strong>list或tuple</strong>:</p>
<pre><code class="language-python">def calc(numbers):
    sum = 0
    for n in numbers:
        sum = sum + n * n
    return sum
#调用
&gt;&gt;&gt; calc([1, 2, 3])
14
&gt;&gt;&gt; calc((1, 3, 5, 7))
84
</code></pre>
<p>方法二:利用可变参数:</p>
<pre><code class="language-python">def calc(*numbers):
    sum = 0
    for n in numbers:
        sum = sum + n * n
    return sum
#直接数字
&gt;&gt;&gt; calc(1, 2)
5
&gt;&gt;&gt; calc()
0
#引用list或tuple:
&gt;&gt;&gt; nums = [1, 2, 3]
&gt;&gt;&gt; calc(*nums)
14
</code></pre>
<p><strong>关键字参数</strong><br>
关键字参数允许你传入0个或任意个含参数名的参数，这些关键字参数在函数内部自动组装为一个<code>dict</code>。</p>
<pre><code class="language-python">def person(name, age, **kw):
    print('name:', name, 'age:', age, 'other:', kw)
#调用
&gt;&gt;&gt; person('Michael', 30)
name: Michael age: 30 other: {}
&gt;&gt;&gt; person('Bob', 35, city='Beijing')
name: Bob age: 35 other: {'city': 'Beijing'}
&gt;&gt;&gt; person('Adam', 45, gender='M', job='Engineer')
name: Adam age: 45 other: {'gender': 'M', 'job': 'Engineer'}
#调用dict
&gt;&gt;&gt; extra = {'city': 'Beijing', 'job': 'Engineer'}
&gt;&gt;&gt; person('Jack', 24, **extra)
name: Jack age: 24 other: {'city': 'Beijing', 'job': 'Engineer'}
</code></pre>
<p><strong>命名关键字参数</strong><br>
只接收<code>city</code>和<code>job</code>作为关键字参数, 这种方式定义的函数如下：<br>
用到特殊分隔符<code>*</code>，<code>*</code>后面的参数被视为命名关键字参数;</p>
<pre><code class="language-python">def person(name, age, *, city, job):
    print(name, age, city, job)
#调用
&gt;&gt;&gt; person('Jack', 24, city='Beijing', job='Engineer')
Jack 24 Beijing Engineer
#已经有了一个可变参数
def person(name, age, *args, city, job):
    print(name, age, args, city, job)
</code></pre>
<p><strong>参数组合</strong><br>
参数定义的顺序必须是：必选参数、默认参数、可变参数、命名关键字参数和关键字参数。</p>
<h2 id="递归函数">递归函数</h2>
<p>计算阶乘<code>n! = 1 x 2 x 3 x ... x n</code></p>
<pre><code class="language-python">def fact(n):
    if n==1:
        return 1
    return n * fact(n - 1)
</code></pre>
<p>递归调用栈溢出的方法是通过<strong>尾递归</strong>优化:</p>
<pre><code class="language-python">def fact(n):
    return fact_iter(n, 1)
def fact_iter(num, product):
    if num == 1:
        return product
    return fact_iter(num - 1, num * product)
#调用:
fact_iter(5, 1)
===&gt; fact_iter(5, 1)
===&gt; fact_iter(4, 5)
===&gt; fact_iter(3, 20)
===&gt; fact_iter(2, 60)
===&gt; fact_iter(1, 120)
===&gt; 120
</code></pre>
<p>汉诺塔的移动可以用递归函数非常简单地实现。</p>
<pre><code class="language-python"># -*- coding: utf-8 -*-
def move(n, a, b, c):
    if n == 1:
        print(a, '--&gt;', c)
    else:
        move(n - 1, a, c, b)
        print(a, '--&gt;', c)
        move(n - 1, b, a, c)
#调用
move(3, 'A', 'B', 'C')
</code></pre>
<h1 id="高级特性">高级特性</h1>
<h2 id="切片">切片</h2>
<pre><code class="language-python">&gt;&gt;&gt; L = ['Michael', 'Sarah', 'Tracy', 'Bob', 'Jack']
&gt;&gt;&gt; L[0:3]
['Michael', 'Sarah', 'Tracy']
</code></pre>
<p><code>L[0:3]</code>表示，从索引<code>0</code>开始取，直到索引<code>3</code>为止，但不包括索引<code>3</code>.<br>
第一个索引是<code>0</code>，可以省略：</p>
<pre><code class="language-python">&gt;&gt;&gt; L[:3]
['Michael', 'Sarah', 'Tracy']
</code></pre>
<p>倒数切片:</p>
<pre><code class="language-python">&gt;&gt;&gt; L[-2:]
['Bob', 'Jack']
&gt;&gt;&gt; L[-2:-1]
['Bob']
&gt;&gt;&gt; L[:10:2]
[0, 2, 4, 6, 8]
</code></pre>
<h2 id="迭代">迭代</h2>
<p><code>dict</code>迭代的是<code>key</code>。如果要迭代<code>value</code>，可以用<code>for value in d.values()</code>，如果要同时迭代<code>key</code>和<code>value</code>，可以用<code>for k, v in d.items()</code>.<br>
判断是否可以迭代:</p>
<pre><code class="language-python">&gt;&gt;&gt; from collections.abc import Iterable
&gt;&gt;&gt; isinstance('abc', Iterable) # str是否可迭代
True
&gt;&gt;&gt; isinstance([1,2,3], Iterable) # list是否可迭代
True
&gt;&gt;&gt; isinstance(123, Iterable) # 整数是否可迭代
False
</code></pre>
<h2 id="列表生成式">列表生成式</h2>
<p>把要生成的元素<code>x * x</code>放到前面，后面跟<code>for</code>循环，就可以把<code>list</code>创建出来;</p>
<pre><code class="language-python">&gt;&gt;&gt; [x * x for x in range(1, 11)]
[1, 4, 9, 16, 25, 36, 49, 64, 81, 100]
</code></pre>
<p>后面还可以接过滤条件：</p>
<pre><code class="language-python">&gt;&gt;&gt; [x * x for x in range(1, 11) if x % 2 == 0]
[4, 16, 36, 64, 100]
</code></pre>
<p>两层循环:</p>
<pre><code class="language-python">&gt;&gt;&gt; [m + n for m in 'ABC' for n in 'XYZ']
['AX', 'AY', 'AZ', 'BX', 'BY', 'BZ', 'CX', 'CY', 'CZ']
</code></pre>
<p><strong>列出</strong>当前目录下的所有<strong>文件和目录名</strong>:</p>
<pre><code class="language-python">&gt;&gt;&gt; import os # 导入os模块，模块的概念后面讲到
&gt;&gt;&gt; [d for d in os.listdir('.')] # os.listdir可以列出文件和目录
['.emacs.d', '.ssh', '.Trash', 'Adlm', 'Applications', 'Desktop', 'Documents', 'Downloads', 'Library', 'Movies', 'Music', 'Pictures', 'Public', 'VirtualBox VMs', 'Workspace', 'XCode']
</code></pre>
<p>使用两个变量来生成list：</p>
<pre><code class="language-python">&gt;&gt;&gt; d = {'x': 'A', 'y': 'B', 'z': 'C' }
&gt;&gt;&gt; [k + '=' + v for k, v in d.items()]
['y=B', 'x=A', 'z=C']
</code></pre>
<p><strong>if...else...</strong><br>
<code>for</code>后面的<code>if</code>是一个筛选条件，不能带<code>else</code></p>
<pre><code class="language-python">&gt;&gt;&gt; [x for x in range(1, 11) if x % 2 == 0 else 0]
  File &quot;&lt;stdin&gt;&quot;, line 1
    [x for x in range(1, 11) if x % 2 == 0 else 0]
                                              ^
SyntaxError: invalid syntax
</code></pre>
<p><code>for</code>前面的部分是一个表达式，它必须根据<code>x</code>计算出一个结果,必须加上else：</p>
<pre><code class="language-python">&gt;&gt;&gt; [x if x % 2 == 0 else -x for x in range(1, 11)]
[-1, 2, -3, 4, -5, 6, -7, 8, -9, 10]
</code></pre>
<h2 id="生成器">生成器</h2>
<p><strong>1.</strong> 将列表生成式的<code>[]</code>变为<code>()</code>即是生成器:</p>
<pre><code class="language-python">&gt;&gt;&gt; L = [x * x for x in range(10)]
&gt;&gt;&gt; L
[0, 1, 4, 9, 16, 25, 36, 49, 64, 81]
&gt;&gt;&gt; g = (x * x for x in range(10))
&gt;&gt;&gt; g
&lt;generator object &lt;genexpr&gt; at 0x1022ef630&gt;
</code></pre>
<p>可以<code>next()</code>不断生成下一个对象,一般用<code>for...in...</code>迭代产生:</p>
<pre><code class="language-python">&gt;&gt;&gt; next(g)
0
&gt;&gt;&gt; next(g)
1
&gt;&gt;&gt; next(g)
4
&gt;&gt;&gt; next(g)
9
&gt;&gt;&gt; g = (x * x for x in range(10))
&gt;&gt;&gt; for n in g:
...     print(n)
... 
0
1
4
9
.
.
81
</code></pre>
<p><strong>2.</strong> 函数中加<code>yield</code>即为<code>generator</code>函数:<br>
斐波拉契数列生成器:</p>
<pre><code class="language-python">def fib(max):
    n, a, b = 0, 0, 1
    while n &lt; max:
        yield b
        a, b = b, a + b
        n = n + 1
    return 'done'
&gt;&gt;&gt; f = fib(6)
&gt;&gt;&gt; f
&lt;generator object fib at 0x104feaaa0&gt;
</code></pre>
<p>调用generator函数会创建一个generator对象，多次调用generator函数会创建多个相互独立的generator。<br>
杨辉三角:</p>
<pre><code class="language-python">def triangles():
    last = [1]
    while True:
        yield last
        next = [last[n]+last[n-1] for n in range(1,len(last))] #中间元素
        next = [1]+next+[1] #首尾加1
        last = next
</code></pre>
<h2 id="迭代器">迭代器</h2>
<p>可以直接作用于<code>for</code>循环的数据类型有以下几种：</p>
<p>一类是集合数据类型，如<code>list</code>、<code>tuple</code>、<code>dict</code>、<code>set</code>、<code>str</code>等；</p>
<p>一类是<code>generator</code>，包括<code>生成器</code>和带<code>yield</code>的<code>generator function</code>。</p>
<p>这些可以直接作用于<code>for</code>循环的对象统称为可迭代对象：<code>Iterable</code>。<br>
使用<code>isinstance()</code>判断一个对象是否是<code>Iterable</code>对象：</p>
<pre><code class="language-python">&gt;&gt;&gt; from collections.abc import Iterable
&gt;&gt;&gt; isinstance([], Iterable)
True
&gt;&gt;&gt; isinstance({}, Iterable)
True
&gt;&gt;&gt; isinstance('abc', Iterable)
True
&gt;&gt;&gt; isinstance((x for x in range(10)), Iterable)
True
&gt;&gt;&gt; isinstance(100, Iterable)
False
</code></pre>
<p>可以被<code>next()</code>函数调用并不断返回下一个值的对象称为迭代器：<code>Iterator</code>。</p>
<p>可以使用<code>isinstance()</code>判断一个对象是否是<code>Iterator</code>对象：</p>
<pre><code class="language-python">&gt;&gt;&gt; from collections.abc import Iterator
&gt;&gt;&gt; isinstance((x for x in range(10)), Iterator)
True
&gt;&gt;&gt; isinstance([], Iterator)
False
&gt;&gt;&gt; isinstance({}, Iterator)
False
&gt;&gt;&gt; isinstance('abc', Iterator)
False
</code></pre>
<p>不能提前知道序列的长度，只能通过<code>next()</code>函数实现按需计算下一个数据，所以<code>Iterator</code>的计算是惰性的，只有在需要返回下一个数据时它才会计算。<br>
<code>Iterator</code>甚至可以表示一个无限大的数据流，例如全体自然数。</p>
<h1 id="函数式编程">函数式编程</h1>
<h2 id="高阶函数">高阶函数</h2>
<p>把函数作为参数传入，这样的函数称为高阶函数，函数式编程就是指这种高度抽象的编程范式。<br>
简单的示例:</p>
<pre><code class="language-python">def add(x, y, f):
    return f(x) + f(y)
</code></pre>
<p><strong>map/reduce</strong></p>
<pre><code class="language-python">&gt;&gt;&gt; def f(x):
...     return x * x
...
&gt;&gt;&gt; r = map(f, [1, 2, 3, 4, 5, 6, 7, 8, 9])
&gt;&gt;&gt; list(r)
[1, 4, 9, 16, 25, 36, 49, 64, 81]
#reduce
reduce(f, [x1, x2, x3, x4]) = f(f(f(x1, x2), x3), x4)
</code></pre>
<p>利用map和reduce编写一个str2float函数:</p>
<pre><code class="language-python">#!/usr/bin/env python3
# -*- coding: utf-8 -*-
from functools import reduce

def str2float(s):
    DIGITS = {'0': 0, '1': 1, '2': 2, '3': 3, '4': 4, '5': 5, '6': 6, '7': 7, '8': 8, '9': 9}
    index = s.find('.')
    def char2num(s):
        return DIGITS[s]
    to_int = reduce(lambda x, y: x * 10 + y, map(char2num, s.replace('.','')))
    return to_int * (10 ** (index - len(s) + 1))                # s含小数点，所以index-len(s)会多减去一位数，需要加1补足

print(str2float('111.11'))
</code></pre>
<p><strong>filter</strong><br>
<code>str.strip( '0' );</code>  # 去除首尾字符 0<br>
<code>str2.strip();</code>  #去除首尾空格<br>
<code>filter()</code>把传入的函数依次作用于每个元素，然后根据返回值是<code>True:</code>保留;还是<code>False:</code>丢弃该元素。<br>
保留奇数:</p>
<pre><code class="language-python">def is_odd(n):
    return n % 2 == 1

list(filter(is_odd, [1, 2, 4, 5, 6, 9, 10, 15]))
# 结果: [1, 5, 9, 15]
</code></pre>
<p>求素数:利用埃氏筛法</p>
<pre><code class="language-python">构造一个从3开始的奇数序列：
def _odd_iter():
    n = 1
    while True:
        n = n + 2
        yield n
定义一个筛选函数：
def _not_divisible(n):
    return lambda x: x % n &gt; 0
定义一个生成器，不断返回下一个素数：
def primes():
    yield 2
    it = _odd_iter() # 初始序列
    while True:
        n = next(it) # 返回序列的第一个数
        yield n
        it = filter(_not_divisible(n), it) # 构造新序列
设置一个退出循环的条件：
# 打印1000以内的素数:
for n in primes():
    if n &lt; 1000:
        print(n)
    else:
        break
</code></pre>
<p>利用<strong>filter()</strong> 筛选出<strong>回数</strong>：</p>
<pre><code class="language-python">#!/usr/bin/env python3
# -*- coding: utf-8 -*-
def is_palindrome(n):
    a=str(n)
    b=a[::-1]
    if a==b:
        return n
# 测试:
output = filter(is_palindrome, range(1, 1000))
print('1~1000:', list(output))
</code></pre>
<p><strong>sorted</strong></p>
<pre><code class="language-python">&gt;&gt;&gt; sorted([36, 5, -12, 9, -21], key=abs)
[5, 9, -12, -21, 36]
</code></pre>
<p><code>key</code>选择的函数是对<code>list</code>的<strong>每项</strong>作用, 而不是作用在整个<code>list</code><br>
要进行反向排序，不必改动key函数，可以传入第三个参数<code>reverse=True</code>：</p>
<pre><code class="language-python">&gt;&gt;&gt; sorted(['bob', 'about', 'Zoo', 'Credit'], key=str.lower, reverse=True)
['Zoo', 'Credit', 'bob', 'about']
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[0206-underscore-Python]]></title>
        <id>https://foreup.github.io/post/0206-underscore-python/</id>
        <link href="https://foreup.github.io/post/0206-underscore-python/">
        </link>
        <updated>2022-02-06T12:13:39.000Z</updated>
        <content type="html"><![CDATA[<h2 id="function">Function</h2>
<h3 id="bind">bind</h3>
<p>错误函数用法示例:</p>
<pre><code class="language-JavaScript">'use strict';
var s = ' Hello  ';
s.trim();
// 输出'Hello'
var fn = s.trim;
fn();
// Uncaught TypeError: String.prototype.trim called on null or undefined
</code></pre>
<p>用<code>fn()</code>取代<code>s.trim()</code>, 上述方法的<code>fn()</code>传入的<code>this</code>指针是<code>undefined</code>, 应该这么用:</p>
<pre><code class="language-JavaScript">var s = ' Hello  ';
var fn = s.trim;
// 调用call并传入s对象作为this:
fn.call(s)
// 输出Hello
</code></pre>
<p><code>bind()</code>可以将<code>s</code>绑定到<code>fn()</code>的<code>this</code>上, 修复之前的错误:</p>
<pre><code class="language-JavaScript">var s = ' Hello  ';
var fn = _.bind(s.trim, s);
fn();
</code></pre>
<h3 id="partial">partial</h3>
<p><code>partial()</code>创建偏函数;<br>
创建<code>pow2N(n)</code>实现<code>Math.pow(2,n)</code>;</p>
<pre><code class="language-JavaScript">'use strict';
var pow2N = _.partial(Math.pow, 2);
pow2N(3); // 8
pow2N(5); // 32
pow2N(10); // 1024
</code></pre>
<p>创建<code>cube(x)</code>，计算<code>x^3</code>，可以用<code>_</code>作占位符，固定住第二个参数：</p>
<pre><code class="language-JavaScript">var cube = _.partial(Math.pow, _, 3);
cube(3); // 27
cube(5); // 125
cube(10); // 1000
</code></pre>
<h3 id="memoize">memoize</h3>
<p>用<code>memoize()</code>自动缓存函数计算的结果：</p>
<pre><code class="language-JavaScript">var factorial = _.memoize(function(n) {
    console.log('start calculate ' + n + '!...');
    var s = 1, i = n;
    while (i &gt; 1) {
        s = s * i;
        i --;
    }
    console.log(n + '! = ' + s);
    return s;
});
// 第一次调用:
factorial(10); // 3628800
// 注意控制台输出:
// start calculate 10!...
// 10! = 3628800
// 第二次调用:
factorial(10); // 3628800
// 控制台没有输出
</code></pre>
<p>但是<code>factorial(9);</code>仍然会重新计算, 可以利用<strong>递归调用</strong>实现阶乘的逐步缓存:</p>
<pre><code class="language-JavaScript">var factorial = _.memoize(function(n) {
    console.log('start calculate ' + n + '!...');
    if (n &lt; 2) {
        return 1;
    }
    return n * factorial(n - 1);
});
factorial(10); // 3628800
// 输出结果说明factorial(1)~factorial(10)都已经缓存了:
// start calculate 10!...
// start calculate 9!...
// start calculate 8!...
// start calculate 7!...
// start calculate 6!...
// start calculate 5!...
// start calculate 4!...
// start calculate 3!...
// start calculate 2!...
// start calculate 1!...
factorial(9); // 362880
// console无输出
</code></pre>
<h3 id="once">once</h3>
<p>once()保证某个函数执行且仅执行一次:</p>
<pre><code class="language-JavaScript">var register = _.once(function () {
    alert('Register ok!');
});
// 测试效果:
register();
register(); //之后无弹窗
register();
</code></pre>
<h3 id="delay">delay</h3>
<pre><code class="language-JavaScript">'use strict';
// 2秒后调用alert():
_.delay(alert, 2000);
</code></pre>
<p>延迟调用的函数有参数:</p>
<pre><code class="language-JavaScript">var log = _.bind(console.log, console);
_.delay(log, 2000, 'Hello,', 'world!');
// 2秒后打印'Hello, world!':
</code></pre>
<h1 id="python">Python</h1>
<h2 id="字符串编码">字符串编码</h2>
<p><code>ord()</code>获取字符的整数表示，<code>chr()</code>把编码转换为对应的字符：</p>
<pre><code class="language-Python">&gt;&gt;&gt; ord('A')
65
&gt;&gt;&gt; ord('中')
20013
&gt;&gt;&gt; chr(66)
'B'
&gt;&gt;&gt; chr(25991)
'文'
</code></pre>
<p>用十六进制这么写<code>str</code>：</p>
<pre><code class="language-Python">&gt;&gt;&gt; '\u4e2d\u6587'  #4e2d&gt;20013&gt;'中'
'中文'
</code></pre>
<p>字符串类型为<code>str</code>，在网络上传输或保存到磁盘需要转化为字节为单位的<code>bytes</code>数据，用带<code>b</code>前缀的单引号或双引号表示：<code>'ABC'</code>和<code>b'ABC'</code>不同。<br>
<strong>encode()与decode()</strong><br>
<code>str</code>通过<code>encode()</code>方法可以编码为指定的<code>bytes</code>：</p>
<pre><code class="language-Python">&gt;&gt;&gt; 'ABC'.encode('ascii')
b'ABC'
&gt;&gt;&gt; '中文'.encode('utf-8')
b'\xe4\xb8\xad\xe6\x96\x87'
&gt;&gt;&gt; '中文'.encode('ascii')
Traceback (most recent call last):
  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
UnicodeEncodeError: 'ascii' codec can't encode characters in position 0-1: ordinal not in range(128)
</code></pre>
<p>把<code>bytes</code>变为<code>str</code>，需要用<code>decode()</code>:</p>
<pre><code class="language-Python">&gt;&gt;&gt; b'ABC'.decode('ascii')
'ABC'
&gt;&gt;&gt; b'\xe4\xb8\xad\xe6\x96\x87'.decode('utf-8')
'中文'
</code></pre>
<p>如果<code>bytes</code>中只有一小部分无效的字节，可以传入<code>errors='ignore'</code>忽略错误的字节：</p>
<pre><code class="language-Python">&gt;&gt;&gt; b'\xe4\xb8\xad\xff'.decode('utf-8', errors='ignore')
'中'
</code></pre>
<p><strong>len()</strong><br>
计算<code>str</code>的字符数用<code>len()</code>:</p>
<pre><code class="language-Python">&gt;&gt;&gt; len('ABC')
3
&gt;&gt;&gt; len('中文')
2
</code></pre>
<p>如果换成<code>bytes</code>就计算字节数:</p>
<pre><code class="language-Python">&gt;&gt;&gt; len(b'ABC')
3
&gt;&gt;&gt; len(b'\xe4\xb8\xad\xe6\x96\x87')
6
&gt;&gt;&gt; len('中文'.encode('utf-8'))
6
</code></pre>
<p><strong>占位符</strong><br>
<code>x%</code> ——十六进制整数;<br>
<code>%s</code>永远起作用，它会把任何数据类型转换为字符串：</p>
<pre><code class="language-Python">&gt;&gt;&gt; 'Age: %s. Gender: %s' % (25, True)
'Age: 25. Gender: True'
#format(), 占位符{0}、{1}…
&gt;&gt;&gt; 'Hello, {0}, 成绩提升了 {1:.1f}%'.format('小明', 17.125)
'Hello, 小明, 成绩提升了 17.1%'
</code></pre>
<p>f-string, 若包含{xxx}，就会以对应的变量替换：</p>
<pre><code class="language-Python">&gt;&gt;&gt; r = 2.5
&gt;&gt;&gt; s = 3.14 * r ** 2
&gt;&gt;&gt; print(f'The area of a circle with radius {r} is {s:.2f}')
The area of a circle with radius 2.5 is 19.62
</code></pre>
<p>除了特殊需求，牢记仅使用<strong>UTF-8</strong>编码。</p>
<h2 id="list与tuple">list与tuple</h2>
<p><strong>list</strong></p>
<pre><code class="language-Python">&gt;&gt;&gt; classmates = ['Michael', 'Bob', 'Tracy']
&gt;&gt;&gt; classmates
['Michael', 'Bob', 'Tracy']
</code></pre>
<p>len()函数可以获得list元素的个数:<code>len(classmates) //3</code></p>
<pre><code class="language-Python">&gt;&gt;&gt; classmates[0]
'Michael'
&gt;&gt;&gt; classmates[1]
'Bob'
&gt;&gt;&gt; classmates[2]
'Tracy'
&gt;&gt;&gt; classmates[3]
Traceback (most recent call last):
  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
IndexError: list index out of range
</code></pre>
<p>访问倒数第n个元素:</p>
<pre><code class="language-Python">&gt;&gt;&gt; classmates[-1]
'Tracy'
&gt;&gt;&gt; classmates[-2]
'Bob'
&gt;&gt;&gt; classmates[-3]
'Michael'
&gt;&gt;&gt; classmates[-4]
Traceback (most recent call last):
  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
IndexError: list index out of range
</code></pre>
<p><strong>追加元素</strong></p>
<pre><code class="language-Python">#从末尾追加
&gt;&gt;&gt; classmates.append('Adam')
&gt;&gt;&gt; classmates
['Michael', 'Bob', 'Tracy', 'Adam']
#按索引插入
&gt;&gt;&gt; classmates.insert(1, 'Jack')
&gt;&gt;&gt; classmates
['Michael', 'Jack', 'Bob', 'Tracy', 'Adam']
#删除末尾
&gt;&gt;&gt; classmates.pop()
'Adam'
&gt;&gt;&gt; classmates
['Michael', 'Jack', 'Bob', 'Tracy']
#索引弹出
&gt;&gt;&gt; classmates.pop(1)
'Jack'
&gt;&gt;&gt; classmates
['Michael', 'Bob', 'Tracy']
#替换
&gt;&gt;&gt; classmates[1] = 'Sarah'
&gt;&gt;&gt; classmates
['Michael', 'Sarah', 'Tracy']
</code></pre>
<p><strong>list套list——多维数组</strong></p>
<pre><code class="language-Python">&gt;&gt;&gt; s = ['python', 'java', ['asp', 'php'], 'scheme']
&gt;&gt;&gt; len(s)
4
</code></pre>
<p><strong>tuple</strong><br>
理解“指向不变”:</p>
<pre><code class="language-Python">&gt;&gt;&gt; t = ('a', 'b', ['A', 'B'])
&gt;&gt;&gt; t[2][0] = 'X'
&gt;&gt;&gt; t[2][1] = 'Y'
&gt;&gt;&gt; t
('a', 'b', ['X', 'Y'])
</code></pre>
<h2 id="条件判断">条件判断</h2>
<pre><code class="language-Python">if &lt;条件判断1&gt;:
    &lt;执行1&gt;
elif &lt;条件判断2&gt;:
    &lt;执行2&gt;
elif &lt;条件判断3&gt;:
    &lt;执行3&gt;
else:
    &lt;执行4&gt;
</code></pre>
<h2 id="循环">循环</h2>
<p><code>for...in...</code><br>
<code>for x in ...</code>循环就是把每个元素代入变量x，然后执行缩进块的语句。</p>
<pre><code class="language-Python">names = ['Michael', 'Bob', 'Tracy']
for name in names:
    print(name)
</code></pre>
<p><code>range(101)</code>生成0-100的整数序列.<br>
<code>while</code>循环</p>
<pre><code class="language-Python">sum = 0
n = 99
while n &gt; 0:
    sum = sum + n
    n = n - 2
print(sum)
</code></pre>
<h2 id="dict与set">dict与set</h2>
<p>dict在其他语言中Map对象。<br>
<strong>总述：</strong> 列表 <code>list[]</code> 、元组 <code>tuple()</code> 、字典 <code>dict{ key : value }</code> 、无序不重复元素集合  <code>set(list[])</code>  ，后两者的key为不可变对象, 元组元素&quot;指向&quot;不可变。<br>
对于 <strong>不变对象</strong> 来说，调用对象自身的任意方法，也不会改变该对象自身的内容。相反，这些方法会创建新的对象并返回，这样，就保证了不可变对象本身永远是不可变的。<br>
重复元素在set中自动被过滤：</p>
<pre><code class="language-python">&gt;&gt;&gt; s = set([1, 1, 2, 2, 3, 3])
&gt;&gt;&gt; s
{1, 2, 3}
</code></pre>
<p>添加元素到<code>set</code>中:</p>
<pre><code class="language-python">&gt;&gt;&gt; s.add(4)
&gt;&gt;&gt; s
{1, 2, 3, 4}
&gt;&gt;&gt; s.add(4)
&gt;&gt;&gt; s
{1, 2, 3, 4}
</code></pre>
<p>删除元素：</p>
<pre><code class="language-python">&gt;&gt;&gt; s.remove(4)
&gt;&gt;&gt; s
{1, 2, 3}
</code></pre>
<p>set可以看成数学意义上的无序和无重复元素的集合，因此，两个set可以做数学意义上的交集、并集等操作：</p>
<pre><code class="language-python">&gt;&gt;&gt; s1 = set([1, 2, 3])
&gt;&gt;&gt; s2 = set([2, 3, 4])
&gt;&gt;&gt; s1 &amp; s2
{2, 3}
&gt;&gt;&gt; s1 | s2
{1, 2, 3, 4}
</code></pre>
<h2 id="调用函数">调用函数</h2>
<p><code>max()</code>函数可以接受任意多个参数, 并返回最大的数:</p>
<pre><code class="language-python">&gt;&gt;&gt; max(1, 2)
2
&gt;&gt;&gt; max(2, 3, 1, -5)
3
</code></pre>
<h2 id="定义函数">定义函数</h2>
<p><strong>空函数</strong></p>
<pre><code class="language-python">def nop():
    pass
</code></pre>
<p><code>pass</code>可以用来作为占位符，比如现在还没想好怎么写函数的代码，就可以先放一个<code>pass</code>，让代码能运行起来, 也可以放到其他语句中:</p>
<pre><code class="language-python">if age &gt;= 18:
    pass
</code></pre>
<p><strong>参数检查</strong><br>
数据类型检查可以用内置函数<code>isinstance()</code>实现：</p>
<pre><code class="language-python">def my_abs(x):
    if not isinstance(x, (int, float)):
        raise TypeError('bad operand type')
    if x &gt;= 0:
        return x
    else:
        return -x
</code></pre>
<p><strong>返回多个值</strong><br>
游戏中经常需要从一个点移动到另一个点，给出坐标、位移和角度，就可以计算出新的坐标：</p>
<pre><code class="language-python">import math

def move(x, y, step, angle=0):
    nx = x + step * math.cos(angle)
    ny = y - step * math.sin(angle)
    return nx, ny
</code></pre>
<p>Python函数返回的仍然是单一值：</p>
<pre><code class="language-python">&gt;&gt;&gt; r = move(100, 100, 60, math.pi / 6)
&gt;&gt;&gt; print(r)
(151.96152422706632, 70.0)
</code></pre>
<h2 id="函数的参数">函数的参数</h2>
<p>明天</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[0205-underscore]]></title>
        <id>https://foreup.github.io/post/0205-underscore/</id>
        <link href="https://foreup.github.io/post/0205-underscore/">
        </link>
        <updated>2022-02-05T12:19:22.000Z</updated>
        <content type="html"><![CDATA[<h1 id="underscore">underscore</h1>
<h2 id="collections">Collections</h2>
<p><strong>map/filter</strong><br>
和<code>Array</code>的<code>map()</code>与<code>filter()</code>类似，但<code>underscore</code>的可以作用于<code>Object</code>。当作用于<code>Object</code>时，传入的函数为<code>function (value, key)</code>，第一个参数接收<code>value</code>，第二个参数接收<code>key</code>：</p>
<pre><code class="language-JavaScript">'use strict';
var obj = {
    name: 'bob',
    school: 'No.1 middle school',
    address: 'xueyuan road'
};
var upper = _.map(obj, function (value, key) {
    return (key+': '+value); //[&quot;name: bob&quot;,&quot;school: No.1 middle school&quot;,&quot;address: xueyuan road&quot;]
});
</code></pre>
<p>对<code>Object</code>作<code>map()</code>操作的<strong>返回</strong>是<code>Array</code>, <code>_.map</code>换成<code>_.mapObject</code>返回为: <code>{&quot;name&quot;:&quot;name: bob&quot;,&quot;school&quot;:&quot;school: No.1 middle school&quot;,&quot;address&quot;:&quot;address: xueyuan road&quot;}</code><br>
<strong>every / some</strong><br>
当集合的所有元素都满足条件时，<code>_.every()</code>函数返回<code>true</code>，当集合的至少一个元素满足条件时，<code>_.some()</code>函数返回<code>true</code>：</p>
<pre><code class="language-JavaScript">'use strict';
var obj = {
    name: 'bob',
    school: 'No.1 middle school',
    address: 'xueyuan road'
};
// 判断key和value是否全部是小写：
var r1 = _.every(obj, function (value, key) {
    return key===key.toLowerCase()&amp;&amp;value===value.toLowerCase();
});
var r2 = _.some(obj, function (value, key) {
    return key===key.toLowerCase()||value===value.toLowerCase();
});
</code></pre>
<p><strong>max / min</strong><br>
直接返回集合中最大和最小的数, 若集合为<code>Object</code>时会忽略<code>key</code>只作用<code>value</code>.<br>
<strong>groupBy</strong><br>
<code>groupBy()</code>把集合的元素按照<code>key</code>归类，<code>key</code>由传入的函数返回：</p>
<pre><code class="language-JavaScript">'use strict';
var scores = [20, 81, 75, 40, 91, 59, 77, 66, 72, 88, 99];
var groups = _.groupBy(scores, function (x) {
    if (x &lt; 60) {
        return 'C';
    } else if (x &lt; 80) {
        return 'B';
    } else {
        return 'A';
    }
});
// 结果:
// {
//   A: [81, 91, 88, 99],
//   B: [75, 77, 66, 72],
//   C: [20, 40, 59]
// }
</code></pre>
<p><strong>shuffle / sample</strong><br>
<code>shuffle()</code>用洗牌算法随机打乱一个集合：</p>
<pre><code class="language-JavaScript">'use strict';
// 注意每次结果都不一样：
_.shuffle([1, 2, 3, 4, 5, 6]); // [3, 5, 4, 6, 2, 1]
</code></pre>
<p><code>sample()</code>则是随机选择一个或多个元素：</p>
<pre><code class="language-JavaScript">'use strict';
// 注意每次结果都不一样：
// 随机选1个：
_.sample([1, 2, 3, 4, 5, 6]); // 2
// 随机选3个：
_.sample([1, 2, 3, 4, 5, 6], 3); // [6, 1, 4]
</code></pre>
<h2 id="arrays">Arrays</h2>
<p><strong>flatten</strong><br>
<code>flatten()</code>接收一个<code>Array</code>，无论这个<code>Array</code>里面嵌套了多少个<code>Array</code>，<code>flatten()</code>最后都把它们变成一个一维数组：</p>
<pre><code class="language-JavaScript">_.flatten([1, [2], [3, [[4], [5]]]]); // [1, 2, 3, 4, 5]
</code></pre>
<p><strong>zip / unzip</strong><br>
<code>zip()</code>把两个或多个数组的所有元素按索引对齐，然后按索引合并成新数组。</p>
<pre><code class="language-JavaScript">'use strict';
var names = ['Adam', 'Lisa', 'Bart'];
var scores = [85, 92, 59];
_.zip(names, scores);
// [['Adam', 85], ['Lisa', 92], ['Bart', 59]]
</code></pre>
<p><code>unzip()</code>则是反过来：</p>
<pre><code class="language-JavaScript">'use strict';
var namesAndScores = [['Adam', 85], ['Lisa', 92], ['Bart', 59]];
_.unzip(namesAndScores);
// [['Adam', 'Lisa', 'Bart'], [85, 92, 59]]
</code></pre>
<p><strong>object</strong></p>
<pre><code class="language-JavaScript">var names = ['Adam', 'Lisa', 'Bart'];
var scores = [85, 92, 59];
_.object(names, scores);
// {Adam: 85, Lisa: 92, Bart: 59}
</code></pre>
<p><strong>range</strong><br>
快速生成序列:</p>
<pre><code class="language-JavaScript">'use strict';
// 从0开始小于10:
_.range(10); // [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
// 从1开始小于11：
_.range(1, 11); // [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
// 从0开始小于30，步长5:
_.range(0, 30, 5); // [0, 5, 10, 15, 20, 25]
// 从0开始大于-10，步长-1:
_.range(0, -10, -1); // [0, -1, -2, -3, -4, -5, -6, -7, -8, -9]
</code></pre>
<p><strong>uniq</strong></p>
<pre><code class="language-JavaScript">var arr = ['Apple', 'orange', 'banana', 'ORANGE', 'apple', 'PEAR'];
var result = _.uniq(arr,function(x){return x.toUpperCase();});
//result:[&quot;Apple&quot;, &quot;orange&quot;, &quot;banana&quot;, &quot;PEAR&quot;]
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[0204-jQuery特定元素拓展]]></title>
        <id>https://foreup.github.io/post/0204-jquery-te-ding-yuan-su-tuo-zhan/</id>
        <link href="https://foreup.github.io/post/0204-jquery-te-ding-yuan-su-tuo-zhan/">
        </link>
        <updated>2022-02-04T12:17:06.000Z</updated>
        <content type="html"><![CDATA[<h2 id="jq针对特定元素的拓展">jQ针对特定元素的拓展</h2>
<p>假设用户调用:<code>$('#main a').external();</code></p>
<pre><code class="language-HTML">&lt;!-- HTML结构 --&gt;
&lt;div id=&quot;test-external&quot;&gt;
    &lt;p&gt;如何学习&lt;a href=&quot;http://jquery.com&quot;&gt;jQuery&lt;/a&gt;？&lt;/p&gt;
    &lt;p&gt;首先，你要学习&lt;a href=&quot;/wiki/1022910821149312&quot;&gt;JavaScript&lt;/a&gt;，并了解基本的&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/HTML&quot;&gt;HTML&lt;/a&gt;。&lt;/p&gt;
&lt;/div&gt;
</code></pre>
<p>则JS代码为:</p>
<pre><code class="language-JavaScript">$.fn.external = function () {
    // return返回的each()返回结果，支持链式调用:
    return this.filter('a').each(function () {  //filter可能需要改为find.
        // 注意: each()内部的回调函数的this绑定为DOM本身!
        var a = $(this);
        var url = a.attr('href');
        if (url &amp;&amp; (url.indexOf('http://')===0 || url.indexOf('https://')===0)) {
            a.attr('href', '#0')
             .removeAttr('target')
             .append(' &lt;i class=&quot;uk-icon-external-link&quot;&gt;&lt;/i&gt;')
             .click(function () {
                if(confirm('你确定要前往' + url + '？')) {
                    window.open(url);
                }
            });
        }
    });
}
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[0203-表单选择-动画-jQ拓展]]></title>
        <id>https://foreup.github.io/post/0203-biao-dan-xuan-ze-dong-hua-jq-tuo-zhan/</id>
        <link href="https://foreup.github.io/post/0203-biao-dan-xuan-ze-dong-hua-jq-tuo-zhan/">
        </link>
        <updated>2022-02-03T12:45:59.000Z</updated>
        <content type="html"><![CDATA[<h1 id="事件">事件</h1>
<h3 id="鼠标事件">鼠标事件</h3>
<ul>
<li><code>click</code>: 鼠标单击时触发；</li>
<li><code>dblclick</code>：鼠标双击时触发；</li>
<li><code>mouseenter</code>：鼠标进入时触发；</li>
<li><code>mouseleave</code>：鼠标移出时触发；</li>
<li><code>mousemove</code>：鼠标在DOM内部移动时触发；</li>
<li><code>hover</code>：鼠标进入和退出时触发两个函数，相当于mouseenter加上mouseleave.</li>
</ul>
<h3 id="键盘事件">键盘事件</h3>
<p>仅作用在当前焦点的DOM上，通常是<code>&lt;input&gt;</code>和<code>&lt;textarea&gt;</code></p>
<ul>
<li><code>keydown</code>：键盘按下时触发；</li>
<li><code>keyup</code>：键盘松开时触发；</li>
<li><code>keypress</code>：按一次键后触发.</li>
</ul>
<h3 id="其他事件">其他事件</h3>
<ul>
<li>focus：当DOM获得焦点时触发；</li>
<li>blur：当DOM失去焦点时触发；</li>
<li>change：当<code>&lt;input&gt;</code>、<code>&lt;select&gt;</code>或<code>&lt;textarea&gt;</code>的内容改变时触发；</li>
<li>submit：当<code>&lt;form&gt;</code>提交时触发；</li>
<li>ready：当页面被载入并且DOM树完成初始化后触发.<br>
<code>ready</code>仅作用于document对象, 在DOM完成初始化后触发，且只触发一次，适合初始化代码.<br>
<strong>简写</strong><br>
<code>$(function () {...})</code>的形式，牢记这是document对象的ready事件处理函数.</li>
</ul>
<h3 id="事件参数">事件参数</h3>
<p>如<code>mousemove</code>和<code>keypress</code>获取鼠标位置和按键的值, 所有事件都会传入Event对象作为参数, 可以从中获取更多信息:<br>
获取鼠标位置:</p>
<pre><code class="language-JavaScript">$(function () {
    $('#testMouseMoveDiv').mousemove(function (e) {
        $('#testMouseMoveSpan').text('pageX = ' + e.pageX + ', pageY = ' + e.pageY);
    });
});
</code></pre>
<h3 id="取消绑定">取消绑定</h3>
<p><code>off('click', function)</code>  其中<code>function</code>是函数名,匿名函数无法解绑, 可以试用<code>off()</code>解除所有绑定,<code>off('click')</code>解除所有的click事件绑定.</p>
<pre><code class="language-JavaScript">function hello() {
    alert('hello!');
}
a.click(hello); // 绑定事件
// 10秒钟后解除绑定:
setTimeout(function () {
    a.off('click', hello);
}, 10000);
</code></pre>
<h3 id="安全限制">安全限制</h3>
<p><code>open()</code>: 打开新窗口, 只能由用户触发的条件执行, 无法直接使用:</p>
<pre><code class="language-JavaScript">var button1 = $('#testPopupButton1');
var button2 = $('#testPopupButton2');
function popupTestWindow() {
    window.open('/');
}
button1.click(function () {
    popupTestWindow();
});
button2.click(function () {
    // 不立刻执行popupTestWindow()，3秒后执行:
    setTimeout(popupTestWindow, 3000);
});
</code></pre>
<h2 id="事件练习">事件练习</h2>
<p>编写函数，绑定事件，实现表单项目的选择与全选操作：</p>
<pre><code class="language-html">&lt;!-- HTML结构 --&gt;
&lt;form id=&quot;test-form&quot; action=&quot;test&quot;&gt;
    &lt;legend&gt;请选择想要学习的编程语言：&lt;/legend&gt;
    &lt;fieldset&gt;
        &lt;p&gt;&lt;label class=&quot;selectAll&quot;&gt;&lt;input type=&quot;checkbox&quot;&gt; &lt;span class=&quot;selectAll&quot;&gt;全选&lt;/span&gt;&lt;span class=&quot;deselectAll&quot;&gt;全不选&lt;/span&gt;&lt;/label&gt; &lt;a href=&quot;#0&quot; class=&quot;invertSelect&quot;&gt;反选&lt;/a&gt;&lt;/p&gt;
        &lt;p&gt;&lt;label&gt;&lt;input type=&quot;checkbox&quot; name=&quot;lang&quot; value=&quot;javascript&quot;&gt; JavaScript&lt;/label&gt;&lt;/p&gt;
        &lt;p&gt;&lt;label&gt;&lt;input type=&quot;checkbox&quot; name=&quot;lang&quot; value=&quot;python&quot;&gt; Python&lt;/label&gt;&lt;/p&gt;
        &lt;p&gt;&lt;label&gt;&lt;input type=&quot;checkbox&quot; name=&quot;lang&quot; value=&quot;ruby&quot;&gt; Ruby&lt;/label&gt;&lt;/p&gt;
        &lt;p&gt;&lt;label&gt;&lt;input type=&quot;checkbox&quot; name=&quot;lang&quot; value=&quot;haskell&quot;&gt; Haskell&lt;/label&gt;&lt;/p&gt;
        &lt;p&gt;&lt;label&gt;&lt;input type=&quot;checkbox&quot; name=&quot;lang&quot; value=&quot;scheme&quot;&gt; Scheme&lt;/label&gt;&lt;/p&gt;
		&lt;p&gt;&lt;button type=&quot;submit&quot;&gt;Submit&lt;/button&gt;&lt;/p&gt;
    &lt;/fieldset&gt;
&lt;/form&gt;
&lt;!--JS函数--&gt;
&lt;script&gt;
$(function () {
let
    form = $('#test-form'),
    langs = form.find('[name=lang]'),
    selectAll = form.find('label.selectAll :checkbox'),
    selectAllLabel = form.find('label.selectAll span.selectAll'),
    deselectAllLabel = form.find('label.selectAll span.deselectAll'),
    invertSelect = form.find('a.invertSelect');
    langs.change();
    selectAll.change(function() {
        if(langs.get().every(e =&gt; e.checked)){
            langs.prop('checked', false);
        } 
        else{
            langs.prop('checked', true);
        }
        langs.change();
    });
    langs.change(function() {
        if(langs.get().every(e =&gt; e.checked)){ 
            selectAll.prop('checked', true);
            selectAllLabel.hide();
            deselectAllLabel.show();
        }
        else{
            selectAll.prop('checked', false);
            deselectAllLabel.hide();
            selectAllLabel.show();
        }
    });
    invertSelect.click(function(){
        for(let x of langs){
            console.log(x);
            x.checked = !x.checked;
        }
        langs.change();
    });
});
&lt;/script&gt;
</code></pre>
<h1 id="动画">动画</h1>
<p>jQuery动画的原理是逐渐改变CSS的值, 有的动画如<code>slideUp()</code>: <code>height</code>从<code>100px</code>逐渐变为<code>0</code>没有效果, 可能是因为很多不是<code>block</code>性质的DOM元素设置<code>height</code>没用.<br>
jQuery也没有实现对<code>background-color</code>的动画效果, 可以使用CSS3的<code>transition</code>.</p>
<h3 id="showhide">show/hide</h3>
<p><code>toggle()</code>根据当前状态决定是<code>show()</code>还是<code>hide()</code>: <code>toggle('slow')</code></p>
<pre><code class="language-JavaScript">var div = $('#test-show-hide');
div.hide(3000); // 在3秒钟内逐渐消失
***可以设置'slow''fast'字符串;
var div = $('#test-show-hide');
div.show('slow'); // 在0.6秒钟内逐渐显示
</code></pre>
<h3 id="slideup-slidedown">slideUp / slideDown</h3>
<p><code>show()</code>和<code>hide()</code>是从左上角逐渐展开或收缩, <code>slideUp()</code>和<code>slideDown()</code>是在垂直方向拉上或拉下；</p>
<pre><code class="language-JavaScript">var div = $('#test-slide');
div.slideUp(3000); // 在3秒钟内逐渐向上消失
</code></pre>
<h3 id="fadein-fadeout">fadeIn / fadeOut</h3>
<p>通过不断设置DOM元素的<code>opacity</code>属性实现, <code>fadeToggle()</code>根据元素当前状态决定;</p>
<pre><code class="language-JavaScript">var div = $('#test-fade');
div.fadeOut('slow'); // 在0.6秒内淡出
</code></pre>
<h3 id="自定义动画animate">自定义动画animate()</h3>
<pre><code class="language-JavaScript">var div = $('#test-animate');
div.animate({
    opacity: 0.25,
    width: '256px',
    height: '256px'
}, 3000); // 在3秒钟内CSS过渡到设定值
</code></pre>
<p><code>animate()</code>传入一个函数，动画结束时，调用函数：<br>
ps: 回调函数参数对于基本动画也是适用的</p>
<pre><code class="language-JavaScript">var div = $('#test-animate');
div.animate({
    opacity: 0.25,
    width: '256px',
    height: '256px'
}, 3000, function () {
    console.log('动画已结束');
    // 恢复至初始状态:
    $(this).css('opacity', '1.0').css('width', '128px').css('height', '128px');
});
</code></pre>
<h3 id="串行动画">串行动画</h3>
<p><code>delay()</code>用来暂停动画;</p>
<pre><code class="language-JavaScript">var div = $('#test-animates');
// 动画效果：slideDown - 暂停 - 放大 - 暂停 - 缩小
div.slideDown(2000)
   .delay(1000)
   .animate({
       width: '256px',
       height: '256px'
   }, 2000)
   .delay(1000)
   .animate({
       width: '128px',
       height: '128px'
   }, 2000);
}
</code></pre>
<h3 id="练习">练习</h3>
<p>制作remove()动画的渐隐效果:</p>
<pre><code class="language-JavaScript">function deleteFirstTR() {
    var tr = $('#test-table&gt;tbody&gt;tr:visible').first();
    tr.fadeOut(1000,function(){tr.remove();});
}
deleteFirstTR();
</code></pre>
<h1 id="ajax">AJAX</h1>
<p>**jQuery利用jsonp实现AJAX跨域访问简单示例:</p>
<ul>
<li>1.创建HTML文件</li>
</ul>
<pre><code class="language-HTML">&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;JSONP测试&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;input type=&quot;button&quot; value=&quot;刷新&quot; onclick=&quot;refreshPrice()&quot; /&gt;
    &lt;p&gt;当前价格:&lt;/p&gt;
    &lt;p id=&quot;current_price&quot;&gt;&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<ul>
<li>2.引用jQuery</li>
</ul>
<pre><code class="language-HTML">&lt;script src=&quot;https://code.jquery.com/jquery-3.3.1.min.js&quot;&gt;&lt;/script&gt;
</code></pre>
<ul>
<li>3.js代码</li>
</ul>
<pre><code class="language-JavaScript">&quot;use strict&quot;
function refreshPrice() {
    let jqxhr = $.ajax('http://api.money.126.net/data/feed/0000001,1399001', {
        method: 'GET',
        dataType: 'jsonp',
        jsonp: 'callback',
        jsonpCallback: 'callbackFunction'
    }).done((data) =&gt; {
        let str = data['0000001'].name + ': ' +
            data['0000001'].price + '；' +
            data['1399001'].name + ': ' +
            data['1399001'].price;
        $('#current_price').slideUp('slow').text(str).slideDown('slow');
    }).fail((xhr, status) =&gt; {
        alert('失败: ' + xhr.status + ', 原因: ' + status);
    });
}

$(() =&gt; {
    refreshPrice();
});
</code></pre>
<h1 id="jquery拓展">jQuery拓展</h1>
<h3 id="编写jquery插件">编写jQuery插件</h3>
<p>利用<code>$.fn</code>对象实现:</p>
<pre><code class="language-JavaScript">$.fn.highlight1 = function () {
    // this已绑定为当前jQuery对象:
    this.css('backgroundColor', '#fffceb').css('color', '#d85030');
    return this; //实现链式调用
}
</code></pre>
<p>简单加参数:</p>
<pre><code class="language-JavaScript">$.fn.highlight2 = function (options) {
    // 要考虑到各种情况:
    // options为undefined
    // options只有部分key
    var bgcolor = options &amp;&amp; options.backgroundColor || '#fffceb';
    var color = options &amp;&amp; options.color || '#d85030';
    this.css('backgroundColor', bgcolor).css('color', color);
    return this;
}
</code></pre>
<p>另一种用jQuery提供的辅助方法<code>$.extend(target, obj1, obj2, ...)</code>，把多个object对象的属性合并到第一个target对象中，遇到同名属性，总是使用靠后的对象的值，也就是越往后优先级越高：</p>
<pre><code class="language-JavaScript">// 把默认值和用户传入的options合并到对象{}中并返回:
var opts = $.extend({}, {
    backgroundColor: '#00a8e6',
    color: '#ffffff'
}, options);
//最终版本的highlight
$.fn.highlight = function (options) {
    // 合并默认值和用户设定值:
    var opts = $.extend({}, $.fn.highlight.defaults, options);
    this.css('backgroundColor', opts.backgroundColor).css('color', opts.color);
    return this;
}
    // 设定默认值:
$.fn.highlight.defaults = {
    color: '#d85030',
    backgroundColor: '#fff8de'
}
    //用户设定默认值
$.fn.highlight.defaults.color = '#fff';
$.fn.highlight.defaults.backgroundColor = '#000';
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[0202-jQuery事件]]></title>
        <id>https://foreup.github.io/post/0202-jquery-shi-jian/</id>
        <link href="https://foreup.github.io/post/0202-jquery-shi-jian/">
        </link>
        <updated>2022-02-02T12:05:02.000Z</updated>
        <content type="html"><![CDATA[<ul>
<li>val()</li>
<li>.css()</li>
<li>addClass('hightlight') removeClass</li>
<li>attr() removeAttr</li>
<li>a.hide() a.show()</li>
<li>text() html()</li>
</ul>
<h1 id="操作dom">操作DOM</h1>
<h2 id="修改text与html">修改text与html</h2>
<p>使用<code>text()</code>和<code>html()</code>, 当无参数时获取节点内容,有参数时修改节点内容;<br>
JQuery获取的对象可以包含任意个节点, 调用<code>.text()</code>会修改对象内所有节点;(利用这点修改css)</p>
<h2 id="修改css">修改css</h2>
<p>使用<code>.css('name', 'value')</code>修改css属性如: <code>background-color</code>, <code>color</code>等, 是否有参数和<code>text()</code>的区别类似;</p>
<pre><code class="language-JavaScript">var div = $('#test-div');
div.hasClass('highlight'); // false， class是否包含highlight
div.addClass('highlight'); // 添加highlight这个class
div.removeClass('highlight'); // 删除highlight这个class
</code></pre>
<h2 id="显示隐藏dom">显示隐藏DOM</h2>
<pre><code class="language-JavaScript">var a = $('a[target=_blank]');
a.hide(); // 隐藏
a.show(); // 显示
</code></pre>
<h2 id="获取dom信息">获取DOM信息</h2>
<ul>
<li>获取浏览器长宽属性</li>
</ul>
<pre><code class="language-JavaScript">// 浏览器可视窗口大小:
$(window).width(); // 800
// HTML文档大小:
$(document).width(); // 800
// 某个div的大小:
var div = $('#test-div');
div.width(); // 600
div.width(400); // 设置CSS属性 width: 400px，是否生效要看CSS是否有效
div.height('200px'); // 设置CSS属性 height: 200px，是否生效要看CSS是否有效
</code></pre>
<p><code>attr()</code>和<code>removeAttr()</code>操作DOM节点属性;</p>
<pre><code class="language-JavaScript">// &lt;div id=&quot;test-div&quot; name=&quot;Test&quot; start=&quot;1&quot;&gt;...&lt;/div&gt;
var div = $('#test-div');
div.attr('data'); // undefined, 属性不存在
div.attr('name'); // 'Test'
div.attr('name', 'Hello'); // div的name属性变为'Hello'
div.removeAttr('name'); // 删除name属性
div.attr('name'); // undefined
</code></pre>
<ul>
<li><code>prop()</code>与<code>attr()</code>方法:</li>
</ul>
<pre><code class="language-JavaScript">&lt;input id=&quot;test-radio&quot; type=&quot;radio&quot; name=&quot;test&quot; checked value=&quot;1&quot;&gt;
</code></pre>
<pre><code>等价于：
</code></pre>
<pre><code>&lt;input id=&quot;test-radio&quot; type=&quot;radio&quot; name=&quot;test&quot; checked=&quot;checked&quot; value=&quot;1&quot;&gt;
</code></pre>
<pre><code>所以:
</code></pre>
<pre><code class="language-JavaScript">var radio = $('#test-radio');
radio.attr('checked'); // 'checked'
radio.prop('checked'); // true
</code></pre>
<p><code>prop()</code>返回值更合理一些,用<code>is()</code>方法判断更好：<br>
还有<code>selected</code>，处理时最好用<code>is(':selected')</code>;</p>
<pre><code class="language-JavaScript">var radio = $('#test-radio');
radio.is(':checked'); // true
</code></pre>
<h2 id="操作表单">操作表单</h2>
<p>jQuery对象统一提供<code>val()</code>方法获取和设置对应的<code>value</code>属性：</p>
<pre><code class="language-JavaScript">/*   &lt;input id=&quot;test-input&quot; name=&quot;email&quot; value=&quot;test&quot;&gt;
    &lt;select id=&quot;test-select&quot; name=&quot;city&quot;&gt;
        &lt;option value=&quot;BJ&quot; selected&gt;Beijing&lt;/option&gt;
        &lt;option value=&quot;SH&quot;&gt;Shanghai&lt;/option&gt;
        &lt;option value=&quot;SZ&quot;&gt;Shenzhen&lt;/option&gt;
    &lt;/select&gt;
    &lt;textarea id=&quot;test-textarea&quot;&gt;Hello&lt;/textarea&gt;   */
var  input = $('#test-input'),
    select = $('#test-select'),
    textarea = $('#test-textarea');
input.val(); // 'test'
input.val('abc@example.com'); // 文本框的内容已变为abc@example.com
select.val(); // 'BJ'
select.val('SH'); // 选择框已变为Shanghai
textarea.val(); // 'Hello'
textarea.val('Hi'); // 文本区域已更新为'Hi'
</code></pre>
<h1 id="修改dom结构">修改DOM结构</h1>
<h2 id="添加与删除dom">添加与删除DOM</h2>
<p><strong>添加:</strong> 粗暴使用<code>html()</code>或使用<code>append()</code>添加至最后,<code>prepend()</code>将节点添加至最前;</p>
<pre><code class="language-JavaScript">// 创建DOM对象:
var ps = document.createElement('li');
ps.innerHTML = '&lt;span&gt;Pascal&lt;/span&gt;';
// 添加DOM对象:
ul.append(ps);
// 添加jQuery对象:
ul.append($('#scheme'));
// 添加函数对象:
ul.append(function (index, html) {
    return '&lt;li&gt;&lt;span&gt;Language - ' + index + '&lt;/span&gt;&lt;/li&gt;';
});
</code></pre>
<p>如果要添加的DOM节点已经存在于HTML文档中，它会首先从文档移除，然后再添加，用<code>append()</code>，可以<strong>移动</strong>一个DOM<strong>节点</strong> ;<br>
同级节点可以用<code>after()</code>或者<code>before()</code>确定插入位置:</p>
<pre><code class="language-JavaScript">//先定位然后利用after()或before()插入节点;
var js = $('#test-div&gt;ul&gt;li:first-child');
js.after('&lt;li&gt;&lt;span&gt;Lua&lt;/span&gt;&lt;/li&gt;');
</code></pre>
<p><strong>删除:</strong><br>
<code>var li = $('#test-div&gt;ul&gt;li');</code><br>
<code>li.remove(); // 所有&lt;li&gt;全被删除</code></p>
<h2 id="练习对html元素排序">练习对HTML元素排序</h2>
<ul>
<li>和0130的排序对照, 有部分相似<br>
<strong>HTML结构:</strong></li>
</ul>
<pre><code class="language-HTML">&lt;div id=&quot;test-div&quot;&gt;
    &lt;ul&gt;
        &lt;li&gt;&lt;span&gt;JavaScript&lt;/span&gt;&lt;/li&gt;
        &lt;li&gt;&lt;span&gt;Python&lt;/span&gt;&lt;/li&gt;
        &lt;li&gt;&lt;span&gt;Swift&lt;/span&gt;&lt;/li&gt;
    &lt;/ul&gt;
&lt;/div&gt;
</code></pre>
<p>用了两种方法,一是获取数组后排序再添加, 二是排序jQuery对象后直接添加;</p>
<pre><code class="language-JavaScript">let arr = ['Pascal','Lua','Ruby'];
let div = $('#test-div ul');
for(let x of arr){
    div.append('&lt;li&gt;&lt;span&gt;'+x+'&lt;/span&gt;&lt;/li&gt;');
}
let div2 = $('#test-div ul&gt;li');
let sort = Array.from(div2).map(x =&gt; x.innerText).sort();
//$('#test-div li').remove();
for(let x of sort){
    div.append('&lt;li&gt;&lt;span&gt;'+x+'&lt;/span&gt;&lt;/li&gt;');
}
console.log(sort);
</code></pre>
<p><strong>等效于===&gt;&gt;：</strong></p>
<pre><code class="language-JavaScript">let arr = ['Pascal','Lua','Ruby'];
let div = $('#test-div ul');
for(let x of arr){
    div.append('&lt;li&gt;&lt;span&gt;'+x+'&lt;/span&gt;&lt;/li&gt;');
}
let div2 = $('#test-div ul&gt;li');
let sort = div2.sort( (a,b) =&gt; a.innerText&gt;b.innerText? 1:-1 );
//$('#test-div li').remove();  append()会先从文档删除节点之后再添加；
div.append(sort);
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[0201-Promise-JQuery选择]]></title>
        <id>https://foreup.github.io/post/0201-promise-jquery-xuan-ze/</id>
        <link href="https://foreup.github.io/post/0201-promise-jquery-xuan-ze/">
        </link>
        <updated>2022-02-01T11:07:14.000Z</updated>
        <content type="html"><![CDATA[<h1 id="promise">Promise</h1>
<p>最简单的Promise例子：生成一个0-2之间的随机数，如果小于1，则等待一段时间后返回成功，否则返回失败：<br>
<code>resolve</code>和<code>reject</code>分别代表成功与失败执行的函数；</p>
<pre><code class="language-JavaScript">function test(resolve, reject) {
    var timeOut = Math.random() * 2;
    log('set timeout to: ' + timeOut + ' seconds.');
    setTimeout(function () {
        if (timeOut &lt; 1) {
            log('call resolve()...');
            resolve('200 OK'); //代表成功
        }
        else {
            log('call reject()...');
            reject('timeout in ' + timeOut + ' seconds.'); //代表失败
        }
    }, timeOut * 1000);
}
</code></pre>
<p>用一个Promise对象来执行上述函数，并根据设定的时间延迟显示结果；</p>
<pre><code class="language-JavaScript">var p1 = new Promise(test);
var p2 = p1.then(function (result) {
    console.log('成功：' + result);
}).catch(function (reason) {
    console.log('失败：' + reason);
});
</code></pre>
<p><code>Promise().then().then....catch()</code> 多任务串行执行.<br>
<code>Promise.all([p1,p2,...])</code> 多任务并行执行<br>
都要成功才进入then,返回结果数组.<br>
<code>Promise.race([p1,p2,...])</code> 多任务赛跑.<br>
then()和catch(),谁先调用算谁的,其它任务中断.</p>
<h2 id="canvas">Canvas</h2>
<ul>
<li>在HTML中设定一块画布的大小与ID等属性；</li>
<li>用JS在画图中绘画；</li>
</ul>
<pre><code class="language-JavaScript">var c=document.getElementById(&quot;myCanvas&quot;);
var ctx=c.getContext(&quot;2d&quot;);
//矩形
ctx.fillStyle=&quot;#FF0000&quot;;
ctx.fillRect(0,0,150,75);
//路径
ctx.moveTo(0,0); //线条开始坐标
ctx.lineTo(200,100); //线条结束坐标
ctx.stroke();
//文本
ctx.font=&quot;30px Arial&quot;; //字体
ctx.fillText(&quot;Hello World&quot;,10,50); //实心字
ctx.strokeText(&quot;Hello World&quot;,10,50); //空心字
//画圆
ctx.beginPath();
ctx.arc(95,50,40,0,2*Math.PI); //x,y,r,start,stop
ctx.stroke();
// ****创建渐变****
  //createLinearGradient(x,y,x1,y1) - 创建线条渐变
  //createRadialGradient(x,y,r,x1,y1,r1) - 创建一个径向/圆渐变
  var grd=ctx.createLinearGradient(0,0,200,0);
  grd.addColorStop(0,&quot;red&quot;);
  grd.addColorStop(1,&quot;white&quot;);
  // 填充渐变
  ctx.fillStyle=grd;
  ctx.fillRect(10,10,150,80);
//图像
var img=document.getElementById(&quot;scream&quot;);
ctx.drawImage(img,10,10);
</code></pre>
<h1 id="jquery选择器">JQuery选择器</h1>
<p><strong>按ID查找</strong><br>
<code>#abc</code>以<code>#</code>开头，返回的对象是jQuery对象；如果<code>id</code>为<code>abc</code>的<code>&lt;div&gt;</code>存在：返回的JQuery对象为<code>[&lt;div id=&quot;abc&quot;&gt;...&lt;/div&gt;]</code>；若不存在：返回<code>[]</code>。</p>
<pre><code class="language-JavaScript">// 查找&lt;div id=&quot;abc&quot;&gt;:
var div = $('#abc');
</code></pre>
<ul>
<li>DOM与JQuery相互转化</li>
</ul>
<pre><code class="language-JavaScript">var div = $('#abc'); // jQuery对象
var divDom = div.get(0); // 假设存在div，获取第1个DOM元素
var another = $(divDom); // 重新把DOM包装为jQuery对象
</code></pre>
<p><strong>按tag查找</strong></p>
<pre><code class="language-JavaScript">var ps = $('p'); // 返回所有&lt;p&gt;节点
ps.length; // 数一数页面有多少个&lt;p&gt;节点
</code></pre>
<p><strong>按class查找</strong><br>
注意在<code>class</code>名称前加<code>.</code></p>
<pre><code class="language-JavaScript">var a = $('.red'); // 所有节点包含`class=&quot;red&quot;`都将返回
// 例如:
// &lt;div class=&quot;red&quot;&gt;...&lt;/div&gt;
// &lt;p class=&quot;green red&quot;&gt;...&lt;/p&gt;
</code></pre>
<ul>
<li>查找<code>class</code>同时包含<code>red</code>和<code>green</code>的节点：</li>
</ul>
<pre><code class="language-JavaScript">var a = $('.red.green'); // 注意没有空格！
// 符合条件的节点：
// &lt;div class=&quot;red green&quot;&gt;...&lt;/div&gt;
// &lt;div class=&quot;blue green red&quot;&gt;...&lt;/div&gt;
</code></pre>
<p><strong>按属性查找</strong><br>
当属性存在空格<code></code> 等特殊字符时需要用双引号<code>&quot;&quot;</code>括起来；</p>
<pre><code class="language-JavaScript">var email = $('[name=email]'); // 找出&lt;??? name=&quot;email&quot;&gt;
var passwordInput = $('[type=password]'); // 找出&lt;??? type=&quot;password&quot;&gt;
var a = $('[items=&quot;A B&quot;]'); // 找出&lt;??? items=&quot;A B&quot;&gt;
</code></pre>
<p>属性的前缀后缀查找</p>
<pre><code class="language-JavaScript">var icons = $('[name^=icon]'); // 找出所有name属性值以icon开头的DOM
// 例如: name=&quot;icon-1&quot;, name=&quot;icon-2&quot;
var names = $('[name$=with]'); // 找出所有name属性值以with结尾的DOM
// 例如: name=&quot;startswith&quot;, name=&quot;endswith&quot;
var icons = $('[class^=&quot;icon-&quot;]'); // 找出所有class包含至少一个以`icon-`开头的DOM
// 例如: class=&quot;icon-clock&quot;, class=&quot;abc icon-home&quot;
</code></pre>
<p><strong>组合查找</strong></p>
<pre><code class="language-JavaScript">var emailInput = $('input[name=email]'); // 不会找出&lt;div name=&quot;email&quot;&gt;, 只查找&lt;input&gt;标签
//tag和class组合查找
var tr = $('tr.red'); // 找出&lt;tr class=&quot;red ...&quot;&gt;...&lt;/tr&gt;
</code></pre>
<p><strong>多项选择器</strong><br>
选出的元素按在HTML中的顺序排序，且不会有重复元素；<br>
<code>&lt;p class=&quot;red green&quot;&gt;</code>不会被下面的<code>$('p.red,p.green')</code>选择两次；</p>
<pre><code class="language-JavaScript">$('p,div'); // 把&lt;p&gt;和&lt;div&gt;都选出来
$('p.red,p.green'); // 把&lt;p class=&quot;red&quot;&gt;和&lt;p class=&quot;green&quot;&gt;都选出来
</code></pre>
<p><strong>以下内容以此为例</strong></p>
<pre><code class="language-html">&lt;!-- HTML结构 --&gt;
&lt;div class=&quot;testing&quot;&gt;
    &lt;ul class=&quot;lang&quot;&gt;
        &lt;li class=&quot;lang-javascript&quot;&gt;JavaScript&lt;/li&gt;
        &lt;li class=&quot;lang-python&quot;&gt;Python&lt;/li&gt;
        &lt;li class=&quot;lang-lua&quot;&gt;Lua&lt;/li&gt;
    &lt;/ul&gt;
&lt;/div&gt;
</code></pre>
<p><strong>层级选择器</strong><br>
用<code>$('ancestor descendant')</code>来选择，层级之间用空格隔开；</p>
<pre><code class="language-JavaScript">$('ul.lang li.lang-javascript'); // [&lt;li class=&quot;lang-javascript&quot;&gt;JavaScript&lt;/li&gt;]
$('div.testing li.lang-javascript'); // [&lt;li class=&quot;lang-javascript&quot;&gt;JavaScript&lt;/li&gt;]
</code></pre>
<p>选择所有的<code>&lt;li&gt;</code>节点：</p>
<pre><code class="language-JavaScript">$('ul.lang li');
$('form[name=upload] input'); //选择范围限定在name属性为upload的表单里
$('form.test p input'); // 多层选择,在form表单选择被&lt;p&gt;包含的&lt;input&gt;
</code></pre>
<p><strong>子选择器</strong><br>
<code>$('parent&gt;child')</code>类似层级选择器，但必须是直系父子关系；</p>
<pre><code class="language-JavaScript">$('ul.lang&gt;li.lang-javascript'); // 可以选出[&lt;li class=&quot;lang-javascript&quot;&gt;JavaScript&lt;/li&gt;]
$('div.testing&gt;li.lang-javascript'); // [], 无法选出，因为&lt;div&gt;和&lt;li&gt;不构成父子关系
</code></pre>
<p><strong>过滤器</strong></p>
<pre><code class="language-JavaScript">$('ul.lang li'); // 选出JavaScript、Python和Lua 3个节点
$('ul.lang li:first-child'); // 仅选出JavaScript
$('ul.lang li:last-child'); // 仅选出Lua
$('ul.lang li:nth-child(2)'); // 选出第N个元素，N从1开始
$('ul.lang li:nth-child(even)'); // 选出序号为偶数的元素
$('ul.lang li:nth-child(odd)'); // 选出序号为奇数的元素
</code></pre>
<h2 id="查找和过滤">查找和过滤</h2>
<p><strong>查找</strong></p>
<ul>
<li>获得一个节点<code>ul</code></li>
<li><code>ul.find()</code>节点内查找</li>
</ul>
<pre><code class="language-html">&lt;!-- HTML结构 --&gt;
&lt;ul class=&quot;lang&quot;&gt;
    &lt;li class=&quot;js dy&quot;&gt;JavaScript&lt;/li&gt;
    &lt;li class=&quot;dy&quot;&gt;Python&lt;/li&gt;
    &lt;li id=&quot;swift&quot;&gt;Swift&lt;/li&gt;
    &lt;li class=&quot;dy&quot;&gt;Scheme&lt;/li&gt;
    &lt;li name=&quot;haskell&quot;&gt;Haskell&lt;/li&gt;
&lt;/ul&gt;
</code></pre>
<p><code>find()</code>查找：</p>
<pre><code class="language-JavaScript">var ul = $('ul.lang'); // 获得&lt;ul&gt;
var dy = ul.find('.dy'); // 获得JavaScript, Python, Scheme
var swf = ul.find('#swift'); // 获得Swift
var hsk = ul.find('[name=haskell]'); // 获得Haskell
</code></pre>
<p>向上查找，使用<code>parent()</code>：</p>
<pre><code class="language-JavaScript">var swf = $('#swift'); // 获得Swift
var parent = swf.parent(); // 获得Swift的上层节点&lt;ul&gt;
var a = swf.parent('.red'); // 获得Swift的上层节点&lt;ul&gt;，同时传入过滤条件。如果ul不符合条件，返回空jQuery对象
</code></pre>
<p>同一层级的节点，可以使用<code>next()</code>和<code>prev()</code>方法：</p>
<pre><code class="language-JavaScript">var swift = $('#swift');
swift.next(); // Scheme
swift.next('[name=haskell]'); // 空的jQuery对象，因为Swift的下一个元素Scheme不符合条件[name=haskell]
swift.prev(); // Python
swift.prev('.dy'); // Python，因为Python同时符合过滤器条件.dy
</code></pre>
<p><strong>过滤</strong><br>
和函数的<code>map</code>、<code>filter</code>类似：<br>
<code>filter()</code>过滤掉不符合条件的节点；</p>
<pre><code class="language-JavaScript">var langs = $('ul.lang li'); // 拿到JavaScript, Python, Swift, Scheme和Haskell
var a = langs.filter('.dy'); // 拿到JavaScript, Python, Scheme
</code></pre>
<p>或者也可以传入函数，注意<code>this</code>的指向的对象为<code>DOM</code></p>
<pre><code class="language-JavaScript">var langs = $('ul.lang li'); // 拿到JavaScript, Python, Swift, Scheme和Haskell
langs.filter(function () {
    return this.innerHTML.indexOf('S') === 0; // 返回S开头的节点
}); // 拿到Swift, Scheme
</code></pre>
<p><code>map()</code>把JQuery对象中的节点转化为数组或其他形式</p>
<pre><code class="language-JavaScript">var langs = $('ul.lang li'); // 拿到JavaScript, Python, Swift, Scheme和Haskell
var arr = langs.map(function () {
    return this.innerHTML;
}).get(); // 用get()拿到包含string的Array：['JavaScript', 'Python', 'Swift', 'Scheme', 'Haskell']
</code></pre>
<p>若JQuery包含多个节点，可以用<code>first()</code>、<code>last()</code>、<code>slice()</code>返回新的JQuery对象，删除不必要节点；</p>
<pre><code class="language-JavaScript">var langs = $('ul.lang li'); // 拿到JavaScript, Python, Swift, Scheme和Haskell
var js = langs.first(); // JavaScript，相当于$('ul.lang li:first-child')
var haskell = langs.last(); // Haskell, 相当于$('ul.lang li:last-child')
var sub = langs.slice(2, 4); // Swift, Scheme, 参数和数组的slice()方法一致
</code></pre>
<h2 id="练习">练习</h2>
<p>对于下面表单，输入值后，用jQuery获取表单的JSON字符串，<code>key</code>和<code>value</code>分别对应每个输入的<code>name</code>和相应的<code>value</code>，例如：<code>{&quot;name&quot;:&quot;Michael&quot;,&quot;email&quot;:...}</code></p>
<pre><code class="language-HTML">&lt;form id=&quot;test-form&quot; action=&quot;#0&quot; onsubmit=&quot;return false;&quot;&gt;
    &lt;p&gt;&lt;label&gt;Name: &lt;input name=&quot;name&quot;&gt;&lt;/label&gt;&lt;/p&gt;
    &lt;p&gt;&lt;label&gt;Email: &lt;input name=&quot;email&quot;&gt;&lt;/label&gt;&lt;/p&gt;
    &lt;p&gt;&lt;label&gt;Password: &lt;input name=&quot;password&quot; type=&quot;password&quot;&gt;&lt;/label&gt;&lt;/p&gt;
    &lt;p&gt;Gender: &lt;label&gt;&lt;input name=&quot;gender&quot; type=&quot;radio&quot; value=&quot;m&quot; checked&gt; Male&lt;/label&gt; &lt;label&gt;&lt;input name=&quot;gender&quot; type=&quot;radio&quot; value=&quot;f&quot;&gt; Female&lt;/label&gt;&lt;/p&gt;
    &lt;p&gt;&lt;label&gt;City: &lt;select name=&quot;city&quot;&gt;
    	&lt;option value=&quot;BJ&quot; selected&gt;Beijing&lt;/option&gt;
    	&lt;option value=&quot;SH&quot;&gt;Shanghai&lt;/option&gt;
    	&lt;option value=&quot;CD&quot;&gt;Chengdu&lt;/option&gt;
    	&lt;option value=&quot;XM&quot;&gt;Xiamen&lt;/option&gt;
    &lt;/select&gt;&lt;/label&gt;&lt;/p&gt;
    &lt;p&gt;&lt;button type=&quot;submit&quot;&gt;Submit&lt;/button&gt;&lt;/p&gt;
&lt;/form&gt;
&lt;!--****JS脚本****--&gt;
&lt;script&gt;
json = {};  //将json初始化为对象
// 利用和表单元素相关的特殊选择器
// 理解filter和map的机制
let tmp1 = $('#test-form :input').not('button').filter(function(){
    //console.log(this.type);
    return this.type !== 'radio' || this.checked;
}).map(function(){
    json[this.name] = this.value;
    return true;
});
json = JSON.stringify(json);
&lt;/script&gt;
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[0131-DOM-文件-AJAX]]></title>
        <id>https://foreup.github.io/post/0131-dom-wen-jian-ajax/</id>
        <link href="https://foreup.github.io/post/0131-dom-wen-jian-ajax/">
        </link>
        <updated>2022-02-01T06:29:33.000Z</updated>
        <content type="html"><![CDATA[<p><strong>删除DOM</strong><br>
删除后子节点不在文档树中，但仍在内存中，可随时将其放到其他地方；</p>
<pre><code class="language-JavaScript">var willBeRemoved = document.getElementById(test-id);
var beRemovedParent = willBeRemoved.parentElement;
var removed = beRemovedParent.removeChild(willBeRemoved);
removed === willBeRemoved; //true;
</code></pre>
<p>ps：要注意，<code>children</code>属性是一个只读属性，删除多个节点时，要注意<code>children</code>属性时刻都在变化；</p>
<ul>
<li>练习删除Web开发不相关的节点</li>
</ul>
<pre><code class="language-JavaScript">let prt = document.getElementById('test-list');
let removeArr = ['JavaScript','HTML','CSS'];
Array.from(prt.children).forEach(function(x){removeArr.includes(x.innerText)? x : prt.removeChild(x);});
</code></pre>
<p><code>[\S]</code>查找非空白字符；</p>
<ul>
<li>注册信息验证练习：</li>
</ul>
<pre><code class="language-html">&lt;!-- HTML结构 --&gt;
&lt;form id=&quot;test-register&quot; action=&quot;#&quot; target=&quot;_blank&quot; onsubmit=&quot;return checkRegisterForm()&quot;&gt;
    &lt;p id=&quot;test-error&quot; style=&quot;color:red&quot;&gt;&lt;/p&gt;
    &lt;p&gt;
        用户名: &lt;input type=&quot;text&quot; id=&quot;username&quot; name=&quot;username&quot;&gt;
    &lt;/p&gt;
    &lt;p&gt;
        口令: &lt;input type=&quot;password&quot; id=&quot;password&quot; name=&quot;password&quot;&gt;
    &lt;/p&gt;
    &lt;p&gt;
        重复口令: &lt;input type=&quot;password&quot; id=&quot;password-2&quot;&gt;
    &lt;/p&gt;
    &lt;p&gt;
        &lt;button type=&quot;submit&quot;&gt;提交&lt;/button&gt; &lt;button type=&quot;reset&quot;&gt;重置&lt;/button&gt;
    &lt;/p&gt;
&lt;/form&gt;

&lt;!-- JavaScript 内容 --&gt;
&lt;script&gt;
var checkRegisterForm = function () {   
    let 
        usc = 0,
        psc = 0,
        in_us = document.getElementById('username'),
        in_ps = document.getElementById('password'),
        in_ps2 = document.getElementById('password-2');
    let 
        usexp = /[0-9a-zA-Z]{3,10}/,
        psexp = /[\S]{6,20}/;
    if(usexp.test(in_us.value)) {usc += 1;}
    if(!usexp.test(in_us.value)) {window.alert('用户名必须是3-10位英文字母或数字；'); return false;}
    if(psexp.test(in_ps.value)){psc += 1;}
    if(!psexp.test(in_ps.value)) {window.alert('口令必须是6-20位；'); return false;}
    if(in_ps.value!==in_ps2.value) {psc--; window.alert('两次口令必须一致；'); return false;}
    return usc&amp;&amp;psc; 
}
&lt;/script&gt;
</code></pre>
<h2 id="操作文件">操作文件</h2>
<ul>
<li>以预览图片为例</li>
</ul>
<pre><code class="language-html">&lt;form method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;
    &lt;p&gt;图片预览：&lt;/p&gt;
    &lt;p&gt;&lt;/p&gt;
    &lt;div id=&quot;test-image-preview&quot; style=&quot;border: 3px solid #ff0000; border-radius: 10px; width: 33%; height: 200px; background-size: contain; background-repeat: no-repeat; background-position: center center;&quot;&gt;
    &lt;/div&gt;
    &lt;p&gt;&lt;/p&gt;
    &lt;p&gt;
      &lt;input type=&quot;file&quot; id=&quot;test-image-file&quot; name=&quot;test&quot;&gt;
    &lt;/p&gt;
    &lt;p id=&quot;test-file-info&quot;&gt;没有选择文件&lt;/p&gt;
&lt;/form&gt;
</code></pre>
<p><strong>js代码及说明</strong><br>
<code>FileReader()</code>对象用来读取文件；<br>
<code>element.target.result</code>将图片编码为<code>base64</code>数据；<br>
<code>preview.style.backgroundImage = 'url(' + data + ')';</code>显示图片；</p>
<pre><code class="language-javascript">//确定js在HTML后加载
window.onload = function() {
var
    fileInput = document.getElementById('test-image-file'),
    info = document.getElementById('test-file-info'),
    preview = document.getElementById('test-image-preview');
// 监听change事件:
fileInput.addEventListener(&quot;change&quot;, previewFunc);
function previewFunc () {
    // 清除背景图片:
    preview.style.backgroundImage = '';
    // 检查文件是否选择:
    if (!fileInput.value) {
        info.innerHTML = '没有选择文件';
        return;
    }
    // 获取File引用:
    var file = fileInput.files[0];
    // 获取File信息:
    info.innerHTML = '文件: ' + file.name + '&lt;br&gt;' +
                     '大小: ' + file.size + '&lt;br&gt;' +
                     '修改: ' + file.lastModified;
    if (file.type !== 'image/jpeg' &amp;&amp; file.type !== 'image/png' &amp;&amp; file.type !== 'image/gif') {
        alert('不是有效的图片文件!');
        return;
    }
    // 读取文件:
    var reader = new FileReader();
    reader.onload = function(e) {
        var data = e.target.result; // 'data:image/jpeg;base64,/9j/4AAQSk...(base64编码)...'            
        preview.style.backgroundImage = 'url(' + data + ')';
        console.log(data);
    };
    // 以DataURL的形式读取文件:
    reader.readAsDataURL(file);
}
} //确定js在HTML后加载
</code></pre>
<h2 id="ajax入门">AJAX入门</h2>
<p><code>var xhttp = new XMLHttpRequest();</code>创建<code>xhttp</code>为名的<code>XMLHttpRequest</code>的对象；<br>
<code>xhttp.onreadystatechange = function() { ... }</code>当<code>XMLHttpRequest</code>的状态改变时回调函数；<br>
<code>xmlhttp.readyState</code>：</p>
<blockquote>
<ul>
<li>0: 请求未初始化</li>
<li>1: 服务器连接已建立</li>
<li>2: 请求已接收</li>
<li>3: 请求处理中</li>
<li>4: 请求已完成，且响应已就绪</li>
</ul>
</blockquote>
<p><code>xmlhttp.status</code>：</p>
<blockquote>
<ul>
<li>200: &quot;OK&quot;</li>
<li>404: 未找到页面</li>
</ul>
</blockquote>
<pre><code class="language-javascript">xmlhttp.open(&quot;GET&quot;,&quot;/try/ajax/gethint.php?q=&quot;+str,true);
xmlhttp.send();
</code></pre>
<p><code>open(method,url,async)</code>使<code>readyState</code>改变：</p>
<blockquote>
<p>method：请求的类型；GET 或 POST，大小写均可；</p>
</blockquote>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[0130-继承-DOM-HTML排序]]></title>
        <id>https://foreup.github.io/post/0130-dom-html-pai-xu/</id>
        <link href="https://foreup.github.io/post/0130-dom-html-pai-xu/">
        </link>
        <updated>2022-01-30T13:15:00.000Z</updated>
        <content type="html"><![CDATA[<h2 id="原型继承">原型继承</h2>
<ol>
<li>创建新函数，并使用<code>call()</code>绑定<code>this</code>；</li>
<li>使用空函数<code>new F()</code>指向父原型；</li>
<li>修复子原型的<code>constructor</code>为子原型；</li>
<li>尽量将封装一个<code>inherits</code>函数实现继承；<br>
<strong>例子</strong></li>
</ol>
<pre><code class="language-javascript">function inherits(Child, Parent) {
    var F = function () {};
    F.prototype = Parent.prototype;
    Child.prototype = new F();
    Child.prototype.constructor = Child;
}
</code></pre>
<ul>
<li>通过inherits继承原型</li>
</ul>
<pre><code class="language-javascript">function Student(props) {
    this.name = props.name || 'Unnamed';
}
Student.prototype.hello = function () {
    alert('Hello, ' + this.name + '!');
}

function PrimaryStudent(props) {
    Student.call(this, props);
    this.grade = props.grade || 1;
}

// 实现原型继承链:
inherits(PrimaryStudent, Student);

// 绑定其他方法到PrimaryStudent原型:
PrimaryStudent.prototype.getGrade = function () {
    return this.grade;
};
</code></pre>
<p>ES6新增的<code>class</code>可以使原型的继承更为简单</p>
<pre><code class="language-javascript">//父对象模型
class Student {
    constructor(name) {
        this.name = name;
    }
    hello() {
        alert('Hello, ' + this.name + '!');
    }
}
//新建对象
var xiaoming = new Student('小明');
xiaoming.hello();
//子对象模型
class PrimaryStudent extends Student {
    constructor(name, grade) {
        super(name); // 记得用super调用父类的构造方法!
        this.grade = grade;
    }

    myGrade() {
        alert('I am at grade ' + this.grade);
    }
}
</code></pre>
<h2 id="dom选择相关">DOM选择相关</h2>
<pre><code class="language-javascript">document.getElementById()  //具有唯一性
document.getElementsByTagName()   //不具有唯一性，返回一组DOM节点
document.getElementsByClassName()   //不具有唯一性
// 先定位ID为'test-table'的节点，再返回其内部所有tr节点：
var trs = document.getElementById('test-table').getElementsByTagName('tr');
// 先定位ID为'test-div'的节点，再返回其内部所有class包含red的节点：
var reds = document.getElementById('test-div').getElementsByClassName('red');
// 获取节点test下的所有直属子节点:
var cs = test.children;
// 获取节点test下第一个、最后一个子节点：
var first = test.firstElementChild;
var last = test.lastElementChild;
// 通过querySelector获取ID为q1的节点：
var q1 = document.querySelector('#q1');
// 通过querySelectorAll获取q1节点内的符合条件的所有节点：
var ps = q1.querySelectorAll('div.highlighted &gt; p');
//练习，评论区回答
var arr = document.querySelectorAll('.c-red.c-green&gt;p');
var arr = document.getElementsByClassName('c-red c-green')[0].children;
var arr = document.querySelectorAll(&quot;.c-red.c-green p&quot;);
// 选择&lt;p&gt;Haskell&lt;/p&gt;:
var haskell = document.querySelector(&quot;#test-div div:last-child p:last-child&quot;);

p.innerHTML = 'ABC &lt;span style=&quot;color:red&quot;&gt;RED&lt;/span&gt; XYZ';
p.innerText = 'ABC';
// 获取&lt;p id=&quot;p-id&quot;&gt;...&lt;/p&gt;
var p = document.getElementById('p-id');
// 设置CSS:
p.style.color = '#ff0000';
p.style.fontSize = '20px';
p.style.paddingTop = '2em';
</code></pre>
<p><strong>插入DOM</strong></p>
<ul>
<li>插入最后<br>
DOM节点为空，如，<code>&lt;div&gt;&lt;/div&gt;</code>，使用<code>innerHTML = '&lt;span&gt;child&lt;/span&gt;'</code>插入新的子节点，但会覆盖原来的子节点；<br>
若非空，则可以用<code>appendChild</code>把一个子节点添加到父节点的最后一个子节点。<br>
原结构：</li>
</ul>
<pre><code class="language-html">&lt;!-- HTML结构 --&gt;
&lt;p id=&quot;js&quot;&gt;JavaScript&lt;/p&gt;
&lt;div id=&quot;list&quot;&gt;
    &lt;p id=&quot;java&quot;&gt;Java&lt;/p&gt;
    &lt;p id=&quot;python&quot;&gt;Python&lt;/p&gt;
    &lt;p id=&quot;scheme&quot;&gt;Scheme&lt;/p&gt;
&lt;/div&gt;
</code></pre>
<p>把<code>&lt;p id=&quot;js&quot;&gt;JavaScript&lt;/p&gt;</code>添加到<code>&lt;div id=&quot;list&quot;&gt;</code>的最后一项：</p>
<pre><code class="language-javascript">var
    js = document.getElementById('js'),
    list = document.getElementById('list');
list.appendChild(js);
</code></pre>
<p>修改后的结构：</p>
<pre><code class="language-HTML">&lt;!-- HTML结构 --&gt;
&lt;div id=&quot;list&quot;&gt;
    &lt;p id=&quot;java&quot;&gt;Java&lt;/p&gt;
    &lt;p id=&quot;python&quot;&gt;Python&lt;/p&gt;
    &lt;p id=&quot;scheme&quot;&gt;Scheme&lt;/p&gt;
    &lt;p id=&quot;js&quot;&gt;JavaScript&lt;/p&gt;
&lt;/div&gt;
</code></pre>
<p>上面是把之前存在的节点移动到新位置，更多需要新建节点，应该如下：<br>
新语句：<br>
<code>document.createElement('p');</code>——创建元素；<br>
<code>d.setAttribute('type', 'text/css');</code>——设置对象属性；</p>
<pre><code class="language-javascript">var
    list = document.getElementById('list'),
    haskell = document.createElement('p');
haskell.id = 'haskell';
haskell.innerText = 'Haskell';
list.appendChild(haskell);

var d = document.createElement('style');
d.setAttribute('type', 'text/css');
d.innerHTML = 'p { color: red }'; //‘p’用来确定是&lt;p&gt;还是其他，如&lt;h1&gt;等；
document.getElementsByTagName('head')[0].appendChild(d);
</code></pre>
<ul>
<li>插入指定位置<br>
使用<code>parentElement.insertBefore(newElement, referenceElement);</code>，插入到<code>referenceElement</code>之前</li>
</ul>
<pre><code class="language-html">&lt;!-- HTML结构 --&gt;
&lt;div id=&quot;list&quot;&gt;
    &lt;p id=&quot;java&quot;&gt;Java&lt;/p&gt;
    &lt;p id=&quot;python&quot;&gt;Python&lt;/p&gt;
    &lt;p id=&quot;scheme&quot;&gt;Scheme&lt;/p&gt;
&lt;/div&gt;
&lt;script&gt;
var
    list = document.getElementById('list'),
    ref = document.getElementById('python'),
    haskell = document.createElement('p');
haskell.id = 'haskell';
haskell.innerText = 'Haskell';
list.insertBefore(haskell, ref);
&lt;/script&gt;
&lt;!-- *新* HTML结构 --&gt;
&lt;div id=&quot;list&quot;&gt;
    &lt;p id=&quot;java&quot;&gt;Java&lt;/p&gt;
    &lt;p id=&quot;haskell&quot;&gt;Haskell&lt;/p&gt;
    &lt;p id=&quot;python&quot;&gt;Python&lt;/p&gt;
    &lt;p id=&quot;scheme&quot;&gt;Scheme&lt;/p&gt;
&lt;/div&gt;
</code></pre>
<p>循环一个父节点的所有子节点，可以通过迭代<code>children</code>属性实现将所有子节点写入某数组中；<br>
复习下面的代码：</p>
<pre><code class="language-html">&lt;!-- HTML结构 --&gt;
&lt;ol id=&quot;test-list&quot;&gt;
    &lt;li class=&quot;lang&quot;&gt;Scheme&lt;/li&gt;
    &lt;li class=&quot;lang&quot;&gt;JavaScript&lt;/li&gt;
    &lt;li class=&quot;lang&quot;&gt;Python&lt;/li&gt;
    &lt;li class=&quot;lang&quot;&gt;Ruby&lt;/li&gt;
    &lt;li class=&quot;lang&quot;&gt;Haskell&lt;/li&gt;
&lt;/ol&gt;
</code></pre>
<p><strong>对HTML内容排序</strong></p>
<pre><code class="language-javascript">//直接排序
list = document.getElementById('test-list');
sort = Array.from(list.children).sort((a, b) =&gt; a.innerText &gt; b.innerText ? 1:-1);
for (let e of sort) list.appendChild(e);
//获取文本排序后返回
list = Array.from(document.getElementById('test-list').children);
sort = list.map(element =&gt; element.innerText).sort();
list.map((element, index) =&gt; element.innerText = sort[index])
//自己最开始写的笨方法
let c = [];
let pz = document.getElementById('test-list');
for(let i = 0; i &lt; pz.children.length; i++){
  c[i] = pz.children[i].innerText;
}
let s = c.sort();
let ht;
for (x of s){
  ht = ht + '&lt;li class=&quot;lang&quot;&gt;' + x +'&lt;/li&gt;' + &quot; &quot;;
}
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[0129小结]]></title>
        <id>https://foreup.github.io/post/0129-xiao-jie/</id>
        <link href="https://foreup.github.io/post/0129-xiao-jie/">
        </link>
        <updated>2022-01-29T10:58:08.000Z</updated>
        <content type="html"><![CDATA[<h2 id="大纲">大纲</h2>
<ul>
<li><em>filter去重</em></li>
<li><em>filter筛选数组中素数</em></li>
<li><em>sort()函数复习</em></li>
<li><em>Array对象</em></li>
<li><em>函数闭包</em></li>
<li><em>箭头函数</em></li>
<li><em>generator对象</em></li>
<li><em>正则表达与Date对象</em></li>
<li><em>Jason</em></li>
</ul>
<h2 id="filter去重">filter去重</h2>
<pre><code class="language-javascript">var r,
arr = ['apple', 'strawberry', 'banana', 'pear', 'apple', 'orange', 'orange', 'strawberry'];
r = arr.filter(function (element, index, self) {
    return self.indexOf(element) === index;});
//PS:element, index, self只是形式？不知道能不能换！
</code></pre>
<h2 id="filter筛选素数">filter筛选素数</h2>
<p>简单的方法可以考虑素数只有<code>1和本身</code>两个因数，麻烦的可以依据定义写函数</p>
<pre><code class="language-javascript">//获得素数函数，可以利用素数只有两个因数，下面的是麻烦的，从定义写的函数！
function get_primes(arr) {
    var brr = arr.filter(function(ss){ 
    var jsw = 0;
    if (ss == 1) {jsw =1}
    else {
    for (var i=2; i&lt;ss; i++) {
    if( ss%i==0 ){
        jsw = jsw +1;
        break;}
    else{ continue; }
    }
} 
     return !jsw;
 });
return brr;
}
//依据因数是否只有2个
arr = arr.filter(function(element, index, self){
    var count = 0;//记录因数的数量
    for(var i=1;i&lt;=element;i++){
       if(element%i===0){
          count++;
        }
    }
    if(element===1){
      return false;
    }
   return count&lt;3;
});
console.log(arr)
</code></pre>
<h2 id="sort函数">sort函数</h2>
<p>在3w网站学过，快速排序，按照<code>-1,0,1</code>的顺序，也可以排列有属性的对象</p>
<pre><code class="language-javascript">//数字小-&gt;大排序；
points.sort(function(a, b){return a - b}); 
//随机排序数组；
points.sort(function(a, b){return 0.5 - Math.random()});
//排序有属性数组,按照字母排序对象
cars.sort(function(a, b){return a.year - b.year});；
function myFunction() {
	var cars = [{type:&quot;BMW&quot;, year:2017},{type:&quot;Audi&quot;, year:2019},{type:&quot;porsche&quot;, year:2018}];
  cars.sort(function(a, b){
    var x = a.type.toLowerCase();
    var y = b.type.toLowerCase();
    if (x &lt; y) {return -1;}
    if (x &gt; y) {return 1;}
    return 0;
  });
  displayCars();
}
</code></pre>
<h2 id="array">Array</h2>
<p>every</p>
<pre><code class="language-jacascript">var arr = ['Apple', 'pear', 'orange'];
console.log(arr.every(function (s) {
    return s.length &gt; 0;
})); // true, 因为每个元素都满足s.length&gt;0
</code></pre>
<p>find<br>
查找符合条件的<strong>第一个</strong>元素，如果找到了，<strong>返回这个元素</strong>；否则返回<code>undefined</code></p>
<pre><code class="language-javascript">var arr = ['Apple', 'pear', 'orange'];
console.log(arr.find(function (s) {
    return s.toLowerCase() === s;
})); // 'pear', 因为pear全部是小写
</code></pre>
<p>findIndex<br>
和<code>find</code>类似，区别：<code>findIndex()</code>会返回这个元素的索引，如果没有找到，返回<code>-1</code>;<br>
forEach<br>
<code>forEach()</code>和<code>map()</code>类似，但不会返回新数组;</p>
<h2 id="函数闭包">函数闭包</h2>
<p>把函数作为结果值返回，返回函数不要引用任何循环变量，或者<strong>后续会发生变化的变量</strong>：再<strong>创建一个函数</strong>，用该函数的参数绑定循环变量当前的值，无论该循环变量后续如何更改，已<strong>绑定</strong>到函数参数的值不变：</p>
<pre><code class="language-javascript">function count() {
    var arr = [];
    for (var i=1; i&lt;=3; i++) {
        arr.push((function (n) {
            return function () {
                return n * n;
            }
        })(i));
    }
    return arr;
}

var results = count();
var f1 = results[0];
var f2 = results[1];
var f3 = results[2];
f1(); // 1
f2(); // 4
f3(); // 9
</code></pre>
<ul>
<li>用了一个“创建一个匿名函数并立刻执行”的语法：</li>
</ul>
<pre><code class="language-JavaScript">(function (x) {
    return x * x;
})(3); // 9
</code></pre>
<ul>
<li>只有函数的语言里，借助闭包，可以封装一个私有变量。我们用JavaScript创建一个计数器：</li>
</ul>
<pre><code class="language-JavaScript">'use strict';
function create_counter(initial) {
    var x = initial || 0;
    return {
        inc: function () {
            x += 1;
            return x;
        }
    }
}
</code></pre>
<ul>
<li>使用：</li>
</ul>
<pre><code class="language-javascript">var c1 = create_counter();
c1.inc(); // 1
c1.inc(); // 2
c1.inc(); // 3

var c2 = create_counter(10);
c2.inc(); // 11
c2.inc(); // 12
c2.inc(); // 13
</code></pre>
<ul>
<li>闭包可以把<strong>多参数</strong>的函数变成<strong>单参数</strong>的函数:</li>
</ul>
<pre><code class="language-javascript">function make_pow(n) {
    return function (x) {
        return Math.pow(x, n);
    }
}

// 创建两个新函数:
var pow2 = make_pow(2);
var pow3 = make_pow(3);

console.log(pow2(5)); // 25
console.log(pow3(7)); // 343
</code></pre>
<h2 id="箭头函数">箭头函数</h2>
<p><code>this</code>的指向与标准<code>function</code>不同，始终指向词法作用域(还是挺糊涂的，以后遇到实例再说吧)；</p>
<pre><code class="language-javascript">var obj = {
    birth: 1990,
    getAge: function () {
        var b = this.birth; // 1990
        var fn = function () {
            return new Date().getFullYear() - this.birth; // this指向window或undefined
        };
        return fn();
    }
};
</code></pre>
<p>箭头函数修复了<code>this</code>的指向</p>
<pre><code class="language-javascript">var obj = {
    birth: 1990,
    getAge: function () {
        var b = this.birth; // 1990
        var fn = () =&gt; new Date().getFullYear() - this.birth; // this指向obj对象
        return fn();
    }
};
obj.getAge(); // 25
</code></pre>
<h2 id="generator">generator</h2>
<p><code>generator</code>由<code>function*</code>定义，可以用<code>yield</code>多次返回，也可以和函数一样用<code>return</code>返回一次。</p>
<pre><code class="language-javascript">function* fib2(max){
    var a=0, b=1, t;
    for (var i = 0; i&lt;max; i++) { 
        t=a;  //也可以直接执行 yield a;
        [a,b]=[b,a+b];
        yield t;
    }
}
//generator的调用，有两种方式
for (var shc of fib2(5)){
    console.log(shc);
}
</code></pre>
<ul>
<li>也可以用<code>next()</code>调用；</li>
</ul>
<pre><code class="language-javascript">var f = fib(5);
f.next(); // {value: 0, done: false}
f.next(); // {value: 1, done: false}
f.next(); // {value: 1, done: false}
f.next(); // {value: 2, done: false}
f.next(); // {value: 3, done: false}
f.next(); // {value: undefined, done: true}
</code></pre>
<p>学了AJAX以后可以体会到generator更大的好处，目前只知道可以保存函数的中间状态；</p>
<h2 id="regexp相关">RegExp相关</h2>
<ul>
<li>基本知识<br>
<code>\w</code>可以匹配一个字母或数字，<code>\d</code>匹配一个数字；<br>
<code>+</code>表示至少一个字符：<code>\s+</code>表示至少有一个空格；<br>
<code>*</code>表示任意个字符，<code>?</code>表示0个或1个字符；<br>
<code>\d{3,8}</code>表示3-8个数字，如<code>'1234567'</code>等；<br>
匹配<code>'010-12345'</code>，<code>-</code>是特殊字符，需要转义，所以号码的正则是<code>\d{3}\-\d{3,8}</code>；<br>
<code>[a-zA-Z\_\$][0-9a-zA-Z\_\$]*</code>表示由字母或下划线、$开头，后接任意个由一个数字、字母或者下划线、$组成的字符串；<br>
<code>A|B</code>可以匹配A或B：<code>(J|j)ava(S|s)cript</code>；<br>
<code>^</code>表示行的开头，<code>^\d</code>必须以数字开头；<br>
<code>$</code>表示行的结束，<code>\d$</code>必须以数字结束：<code>js</code>也可以匹配<code>jsp</code>，但<code>js$</code>只能匹配<code>js</code>;</li>
<li>创建正则表达式：</li>
</ul>
<pre><code class="language-javascript">var re1 = /ABC\-001/;
var re2 = new RegExp('ABC\\-001');

re1; // /ABC\-001/
re2; // /ABC\-001/
</code></pre>
<ul>
<li>切分字符串</li>
</ul>
<pre><code class="language-javascript">'a b   c'.split(' '); // ['a', 'b', '', '', 'c'];
'a b   c'.split(/\s+/); // ['a', 'b', 'c'];
'a,b, c  d'.split(/[\s\,]+/); // ['a', 'b', 'c', 'd'];
//至少一个[' '或','或';']
'a,b;; c  d'.split(/[\s\,\;]+/); // ['a', 'b', 'c', 'd'];
</code></pre>
<ul>
<li>分组<br>
除了匹配外，正则还可以提取字符串，<code>()</code>表示的就是要提取的分组；</li>
</ul>
<pre><code class="language-JavaScript">//先匹配字符串
var re = /^(\d{3})-(\d{3,8})$/;
re.exec('010-12345'); // ['010-12345', '010', '12345']
re.exec('010 12345'); // null
</code></pre>
<p><code>exec()</code>方法在匹配成功后，会返回一个<code>Array</code>，第一个元素是正则表达式匹配到的整个字符串，后面的字符串表示匹配成功的子串；失败则会返回<code>null</code>。</p>
<pre><code class="language-JavaScript">var re = /^(0[0-9]|1[0-9]|2[0-3]|[0-9])\:(0[0-9]|1[0-9]|2[0-9]|3[0-9]|4[0-9]|5[0-9]|[0-9])\:(0[0-9]|1[0-9]|2[0-9]|3[0-9]|4[0-9]|5[0-9]|[0-9])$/;
re.exec('19:05:30'); // ['19:05:30', '19', '05', '30']
</code></pre>
<p>上述可以识别合法日期。<br>
但是对于日期的识别可能会出问题：</p>
<pre><code class="language-JavaScript">var re = /^(0[1-9]|1[0-2]|[0-9])-(0[1-9]|1[0-9]|2[0-9]|3[0-1]|[0-9])$/;
</code></pre>
<p>对于<code>'2-30'</code>，<code>'4-31'</code>非法日期正则很难去识别，需要程序实现；</p>
<ul>
<li>贪婪匹配：正则<strong>默认贪婪</strong>匹配</li>
</ul>
<pre><code class="language-JavaScript">var re = /^(\d+)(0*)$/;
re.exec('102300'); // ['102300', '102300', '']
</code></pre>
<p>导致<code>0*</code>无法匹配到字符串，可以加个<code>？</code>来解决(尽可能少匹配)：</p>
<pre><code class="language-JavaScript">var re = /^(\d+?)(0*)$/;
re.exec('102300'); // ['102300', '1023', '00']
</code></pre>
<ul>
<li>全局匹配<br>
<code>g</code>，表示全局匹配；<code>i</code>，表示忽略大小写；<code>m</code>，表示多行匹配。</li>
</ul>
<pre><code class="language-JavaScript">var r1 = /test/g;
// 等价于:
var r2 = new RegExp('test', 'g');
</code></pre>
<p>全局匹配可以多次执行<code>exec()</code>方法来搜索一个匹配的字符串，指定<code>g</code>标志后，每次运行<code>exec()</code>，正则表达式本身会更新<code>lastIndex</code>属性，表示上次匹配到的最后索引：</p>
<pre><code class="language-JavaScript">var s = 'JavaScript, VBScript, JScript and ECMAScript';
var re=/[a-zA-Z]+Script/g;
// 使用全局匹配:
re.exec(s); // ['JavaScript']
re.lastIndex; // 10
re.exec(s); // ['VBScript']
re.lastIndex; // 20
re.exec(s); // ['JScript']
re.lastIndex; // 29
re.exec(s); // ['ECMAScript']
re.lastIndex; // 44
re.exec(s); // null，直到结束仍没有匹配到
</code></pre>
<p>全局匹配不能使用不能使用<code>/^...$/</code></p>
<h2 id="jason学习">Jason学习</h2>
<p>学习中看了篇评论区文章，箭头函数不乱用，箭头函数本身无this、arguments等属性，使用箭头函数一定要在外层套一层函数，使this在可见范围内，对象无法分割作用域（对象内的箭头函数无法确定this的指向），定义变量const&gt;let&gt;var尽量依次使用。</p>
<h2 id="创建对象">创建对象</h2>
<p>通过函数创建对象，理解还较浅，注意<code>prototype</code>与<code>__proto__</code>以及<code>原型链</code></p>
<pre><code class="language-javascript">function Cat(name) {
    this.name = name;
}
Cat.prototype.say = function(){
    return 'Hello, ' + this.name + '!';
}
</code></pre>
<p>可以用一个<code>createStudent</code>来内部封装<code>new</code></p>
<pre><code class="language-JavaScript">function Student(props) {
	this.name = props.name || '匿名';
	this.grade = props.grade || 1;
}

Student.prototype.hello = function () {
	alert('Hello, ' + this.name + '!');
}

function createStudent(props) {
	return new Student(props || {})
}
</code></pre>
<p><code>createStudent</code>的参数非常灵活，可以不传也可以如下：</p>
<pre><code class="language-JavaScript">var xiaoming = createStudent({
	name: '小明'
});

xiaoming.grade; 
</code></pre>
]]></content>
    </entry>
</feed>